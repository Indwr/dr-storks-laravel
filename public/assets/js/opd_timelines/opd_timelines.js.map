{"version":3,"sources":["webpack:///./resources/assets/js/opd_timelines/opd_timelines.js"],"names":["$","document","ready","getOpdTimelines","val","datetimepicker","DatetimepickerDefaults","format","useCurrent","sideBySide","minDate","moment","appointmentDate","on","e","preventDefault","loadingButton","jQuery","this","find","button","data","opdTimelineCreateUrl","newRecord","setTimeout","ajaxCallIsRunning","ajaxCallInProgress","opdTimelineId","renderTimelineData","window","id","ajax","url","opdTimelinesUrl","type","success","result","opd_timeline_document_url","ext","split","pop","toLowerCase","attr","pdfDocumentImageUrl","docxDocumentImageUrl","show","hide","defaultDocumentImageUrl","title","date","description","visible_to_person","prop","modal","ajaxCallCompleted","error","manageAjaxErrors","event","editRecord","location","reload","deleteOpdTimelineItem","header","swal","text","showCancelButton","closeOnConfirm","showLoaderOnConfirm","confirmButtonColor","cancelButtonColor","cancelButtonText","confirmButtonText","dataType","obj","timer","responseJSON","message","resetModalForm","extension","isValidTimelineDocument","isEmpty","html","displayDocument","inputSelector","validationMessageSelector","inArray","opdPatientDepartmentId"],"mappings":"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","file":"/assets/js/opd_timelines/opd_timelines.js","sourcesContent":["$(document).ready(function () {\n    'use strict';\n\n    getOpdTimelines($('#opdPatientDepartmentId').val());\n\n    $('#timelineDate, #editTimelineDate').\n        datetimepicker(DatetimepickerDefaults({\n            format: 'YYYY-MM-DD',\n            useCurrent: true,\n            sideBySide: true,\n            minDate: moment(appointmentDate).format('YYYY-MM-DD'),\n        }));\n\n    $(document).on('submit', '#addOpdTimelineNewForm', function (e) {\n        e.preventDefault();\n        let loadingButton = jQuery(this).find('#btnOpdTimelineSave');\n        loadingButton.button('loading');\n        let data = {\n            'formSelector': $(this),\n            'url': opdTimelineCreateUrl,\n            'type': 'POST',\n            'tableSelector': '#tbl',\n        };\n        newRecord(data, loadingButton, '#addOpdTimelineModal');\n        setTimeout(function () {\n            getOpdTimelines($('#opdPatientDepartmentId').val());\n        }, 500);\n    });\n\n    $(document).on('click', '.edit-timeline-btn', function () {\n        if (ajaxCallIsRunning) {\n            return;\n        }\n        ajaxCallInProgress();\n        let opdTimelineId = $(this).data('timeline-id');\n        renderTimelineData(opdTimelineId);\n    });\n\n    window.renderTimelineData = function (id) {\n        $.ajax({\n            url: opdTimelinesUrl + '/' + id + '/edit',\n            type: 'GET',\n            success: function (result) {\n                if (result.success) {\n                    if (result.data.opd_timeline_document_url != '') {\n                        let ext = result.data.opd_timeline_document_url.split(\n                            '.').\n                            pop().\n                            toLowerCase();\n                        if (ext == 'pdf') {\n                            $('#editPreviewTimelineImage').\n                                attr('src', pdfDocumentImageUrl);\n                        } else if ((ext == 'docx') || (ext == 'doc')) {\n                            $('#editPreviewTimelineImage').\n                                attr('src', docxDocumentImageUrl);\n                        } else {\n                            $('#editPreviewTimelineImage').\n                                attr('src',\n                                    result.data.opd_timeline_document_url);\n                        }\n                        $('#timeDocumentUrl').show();\n                    } else {\n                        $('#timeDocumentUrl').hide();\n                        $('#editPreviewTimelineImage').\n                            attr('src', defaultDocumentImageUrl);\n                    }\n                    $('#opdTimelineId').val(result.data.id);\n                    $('#editTimelineTitle').val(result.data.title);\n                    $('#editTimelineDate').val(result.data.date);\n                    $('#editTimelineDescription').val(result.data.description);\n                    $('#timeDocumentUrl').\n                        attr('href', result.data.opd_timeline_document_url);\n                    (result.data.visible_to_person == 1)\n                        ? $('#editTimelineVisibleToPerson').\n                            prop('checked', true)\n                        : $('#editTimelineVisibleToPerson').\n                            prop('checked', false);\n                    $('#editOpdTimelineModal').modal('show');\n                    ajaxCallCompleted();\n                }\n            },\n            error: function (result) {\n                manageAjaxErrors(result);\n            },\n        });\n    };\n\n    $(document).on('submit', '#editOpdTimelineForm', function (event) {\n        event.preventDefault();\n        let loadingButton = jQuery(this).find('#btnOpdTimelineEdit');\n        loadingButton.button('loading');\n        let id = $('#opdTimelineId').val();\n        let url = opdTimelinesUrl + '/' + id;\n        let data = {\n            'formSelector': $(this),\n            'url': url,\n            'type': 'POST',\n            'tableSelector': '#tbl',\n        };\n        editRecord(data, loadingButton, '#editOpdTimelineModal');\n        setTimeout(function () {\n            location.reload();\n        }, 500);\n    });\n\n    $(document).on('click', '.delete-timeline-btn', function () {\n        let id = $(this).data('timeline-id');\n        deleteOpdTimelineItem(opdTimelinesUrl + '/' + id, 'OPD Timeline');\n    });\n\n    window.deleteOpdTimelineItem = function (url, header) {\n        swal({\n                title: 'Delete !',\n                text: 'Are you sure want to delete this \"' + header + '\" ?',\n                type: 'warning',\n                showCancelButton: true,\n                closeOnConfirm: false,\n                showLoaderOnConfirm: true,\n                confirmButtonColor: '#5cb85c',\n                cancelButtonColor: '#d33',\n                cancelButtonText: 'No',\n                confirmButtonText: 'Yes',\n            },\n            function () {\n                $.ajax({\n                    url: url,\n                    type: 'DELETE',\n                    dataType: 'json',\n                    success: function (obj) {\n                        if (obj.success) {\n                            setTimeout(function () {\n                                getOpdTimelines(\n                                    $('#opdPatientDepartmentId').val());\n                            }, 500);\n                        }\n                        swal({\n                            title: 'Deleted!',\n                            text: header + ' has been deleted.',\n                            type: 'success',\n                            timer: 2000,\n                        });\n                    },\n                    error: function (data) {\n                        swal({\n                            title: '',\n                            text: data.responseJSON.message,\n                            type: 'error',\n                            timer: 5000,\n                        });\n                    },\n                });\n            });\n    };\n\n    $('#addOpdTimelineModal').on('hidden.bs.modal', function () {\n        resetModalForm('#addOpdTimelineNewForm', '#timeLinevalidationErrorsBox');\n        $('#previewTimelineImage').attr('src', defaultDocumentImageUrl);\n    });\n\n    $('#editOpdTimelineModal').on('hidden.bs.modal', function () {\n        resetModalForm('#editOpdTimelineForm', '#editTimelineValidationErrorsBox');\n    });\n});\n\n$(document).on('change', '#timelineDocumentImage', function () {\n    let extension = isValidTimelineDocument($(this), '#timeLinevalidationErrorsBox');\n    if (!isEmpty(extension) && extension != false) {\n        $('#timeLinevalidationErrorsBox').html('').hide();\n        displayDocument(this, '#previewTimelineImage', extension);\n    }\n});\n\n$(document).on('change', '#editTimelineDocumentImage', function () {\n    let extension = isValidTimelineDocument($(this),\n        '#editTimelineValidationErrorsBox');\n    if (!isEmpty(extension) && extension != false) {\n        $('#editTimelineValidationErrorsBox').html('').hide();\n        displayDocument(this, '#editPreviewTimelineImage', extension);\n    }\n});\n\nwindow.isValidTimelineDocument = function (\n    inputSelector, validationMessageSelector) {\n    let ext = $(inputSelector).val().split('.').pop().toLowerCase();\n    if ($.inArray(ext, ['png', 'jpg', 'jpeg', 'pdf', 'doc', 'docx']) == -1) {\n        $(inputSelector).val('');\n        $(validationMessageSelector).\n            html(\n                'The document must be a file of type: jpeg, jpg, png, pdf, doc, docx.').\n            show();\n        return false;\n    }\n    return ext;\n};\n\nwindow.getOpdTimelines = function (opdPatientDepartmentId) {\n    $.ajax({\n        url: opdTimelinesUrl,\n        type: 'get',\n        data: { id: opdPatientDepartmentId },\n        success: function (data) {\n            $('#opdTimelines').html(data);\n        },\n    });\n};\n"],"sourceRoot":""}