{"version":3,"sources":["webpack:///./resources/assets/js/live_consultations/live_meetings.js"],"names":["$","document","ready","DataTable","processing","serverSide","ajax","url","liveMeetingUrl","data","status","find","val","columnDefs","targets","defaultContent","columns","row","id","consultation_title","name","render","consultation_date","moment","format","adminRole","doctorRole","status_text","meta","start_url","join_url","prepareTemplateRender","change","reload","drawCallback","this","api","state","clear","select2","width","datetimepicker","DatetimepickerDefaults","useCurrent","sideBySide","minDate","Date","on","event","preventDefault","loadingButton","jQuery","button","liveMeetingCreateUrl","type","serialize","success","result","displaySuccessMessage","message","modal","setTimeout","error","printErrorMessage","resetModalForm","loggedInUserId","trigger","statusId","manageAjaxErrors","ajaxCallIsRunning","ajaxCallInProgress","liveConsultationId","currentTarget","startRenderData","window","liveConsultation","liveMeeting","text","user","full_name","consultation_duration_minutes","append","zoomLiveData","addClass","attr","ajaxCallCompleted","meetingId","host_video","participant_video","isEmpty","description","liveMeetingId","renderData","meetingUsers","prop","complete","deleteItem","empty"],"mappings":"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","file":"/assets/js/live_consultations/live_meetings.js","sourcesContent":["$(document).ready(function () {\n    'use strict';\n\n    let tbl = $('#liveMeetingTable').DataTable({\n        processing: true,\n        serverSide: true,\n        'order': [[0, 'desc']],\n        ajax: {\n            url: liveMeetingUrl,\n            data: function (data) {\n                data.status = $('#statusArr').find('option:selected').val();\n            },\n        },\n        columnDefs: [\n            {\n                targets: '_all',\n                defaultContent: 'N/A',\n            },\n            {\n                'targets': [3],\n                'orderable': false,\n                'className': 'text-center',\n                'width': '10%',\n            },\n            {\n                'targets': [5],\n                'orderable': false,\n                'className': 'text-center',\n                'width': '8%',\n            },\n        ],\n        columns: [\n            {\n                data: function (row) {\n                    return '<a href=\"#\" class=\"show-data\" data-id=\"' + row.id +\n                        '\">' + row.consultation_title + '</a>';\n                },\n                name: 'consultation_title',\n            },\n            {\n                data: function (row) {\n                    return row;\n                },\n                render: function (row) {\n                    if (row.consultation_date === null) {\n                        return 'N/A';\n                    }\n\n                    return moment(row.consultation_date, 'YYYY-MM-DD hh:mm:ss').\n                        format('Do MMM, YYYY hh:mm A');\n                },\n                name: 'consultation_date',\n            },\n            {\n                data: 'user.full_name',\n                name: 'user.first_name',\n            },\n            {\n                data: function (row) {\n                    if (adminRole || doctorRole) {\n                        return `<select class=\"change-status\" data-id=\"${row.id}\">` +\n                            `<option value=\"0\" ${row.status == 0\n                                ? 'selected'\n                                : ''}>Awaited</option>\n                            <option value=\"1\" ${row.status == 1\n                                ? 'selected'\n                                : ''}>Cancelled</option>\n                            <option value=\"2\" ${row.status == 2\n                                ? 'selected'\n                                : ''}>Finished</option>`\n                            + `</select>`;\n                    }\n                    return row.status_text;\n                },\n                name: 'status',\n            },\n            {\n                data: 'password',\n                name: 'password',\n            },\n            {\n                data: function (row) {\n                    let data = [\n                        {\n                            'id': row.id,\n                            'status': row.status,\n                            'url': !(adminRole || doctorRole)\n                                ? row.meta.join_url\n                                : row.meta.start_url,\n                            'title': !(adminRole || doctorRole)\n                                ? 'Join Meeting'\n                                : 'Start Meeting',\n                            'isDoctor': doctorRole,\n                            'isAdmin': adminRole,\n                            'isMeetingFinished': row.status == 2 ? true : false,\n                        }];\n                    return prepareTemplateRender('#liveMeetingActionTemplate',\n                        data);\n                }, name: 'user.last_name',\n            },\n        ],\n        'fnInitComplete': function () {\n            $('#statusArr').change(function () {\n                $('#liveMeetingTable').DataTable().ajax.reload(null, true);\n            });\n        },\n        drawCallback: function () {\n            this.api().state.clear();\n            $('.change-status').select2({\n                width: '100%',\n            });\n        },\n    });\n\n    $('#userId,.editUserId, #statusArr').select2({\n        width: '100%',\n    });\n    $('.consultation-date, .edit-consultation-date').\n        datetimepicker(DatetimepickerDefaults({\n            format: 'YYYY-MM-DD h:mm A',\n            useCurrent: true,\n            sideBySide: true,\n            minDate: new Date(),\n        }));\n\n    $(document).on('submit', '#addNewForm', function (event) {\n        event.preventDefault();\n        let loadingButton = jQuery(this).find('#btnSave');\n        loadingButton.button('loading');\n        $.ajax({\n            url: liveMeetingCreateUrl,\n            type: 'POST',\n            data: $(this).serialize(),\n            success: function (result) {\n                if (result.success) {\n                    displaySuccessMessage(result.message);\n                    $('#addModal').modal('hide');\n                    $('#liveMeetingTable').DataTable().ajax.reload(null, false);\n                    setTimeout(function () {\n                        loadingButton.button('reset');\n                    }, 2500);\n                }\n            },\n            error: function (result) {\n                printErrorMessage('#validationErrorsBox', result);\n                setTimeout(function () {\n                    loadingButton.button('reset');\n                }, 2000);\n            },\n        });\n    });\n    $('#addModal').on('hidden.bs.modal', function () {\n        resetModalForm('#addNewForm', '#validationErrorsBox');\n        $('#userId').val(loggedInUserId).trigger('change.select2');\n    });\n\n    $(document).on('change', '.change-status', function () {\n        let statusId = $(this).val();\n        $.ajax({\n            url: liveMeetingUrl + '/change-status',\n            type: 'GET',\n            data: { statusId: statusId, id: $(this).data('id') },\n            success: function (result) {\n                if (result.success) {\n                    displaySuccessMessage(result.message);\n                    $('#liveMeetingTable').DataTable().ajax.reload(null, false);\n                }\n            },\n            error: function (result) {\n                manageAjaxErrors(result);\n            },\n        });\n    });\n});\n\n$(document).on('click', '.start-btn', function (event) {\n    if (ajaxCallIsRunning) {\n        return;\n    }\n    ajaxCallInProgress();\n    let liveConsultationId = $(event.currentTarget).data('id');\n    startRenderData(liveConsultationId);\n});\n\nwindow.startRenderData = function (id) {\n    $.ajax({\n        url: liveMeetingUrl + '/' + id + '/start',\n        type: 'GET',\n        success: function (result) {\n            if (result.success) {\n                let liveConsultation = result.data;\n                $('#startLiveConsultationId').\n                    val(liveConsultation.liveMeeting.id);\n                $('.start-modal-title').\n                    text(liveConsultation.liveMeeting.consultation_title);\n                $('.host-name').\n                    text(liveConsultation.liveMeeting.user.full_name);\n                $('.date').text(liveConsultation.liveMeeting.consultation_date);\n                $('.minutes').\n                    text(\n                        liveConsultation.liveMeeting.consultation_duration_minutes);\n                $('#startModal').\n                    find('.status').\n                    append((liveConsultation.zoomLiveData.data.status ===\n                        'started') ? $('.status').text('Started') : $(\n                        '.status').text('Awaited'));\n                !(adminRole || doctorRole)\n                    ? $('.start').\n                        attr('href', liveConsultation.liveMeeting.meta.join_url)\n                    : ((liveConsultation.zoomLiveData.data.status ===\n                    'started') ? $('.start').addClass('disabled') : $('.start').\n                        attr('href', liveConsultation.liveMeeting.meta.start_url));\n                $('#startModal').modal('show');\n                ajaxCallCompleted();\n            }\n        },\n        error: function (result) {\n            manageAjaxErrors(result);\n        },\n    });\n};\n\n$(document).on('click', '.show-data', function (event) {\n    let meetingId = $(event.currentTarget).data('id');\n    $.ajax({\n        url: liveMeetingUrl + '/' + meetingId,\n        type: 'GET',\n        success: function (result) {\n            if (result.success) {\n                let liveMeeting = result.data;\n                $('#showLiveConsultationId').val(liveMeeting.id);\n                $('#meetingTitle').text(liveMeeting.consultation_title);\n                $('#meetingDate').text(liveMeeting.consultation_date);\n                $('#meetingMinutes').\n                    text(liveMeeting.consultation_duration_minutes);\n\n                (liveMeeting.host_video == 0) ? $('#meetingHost').\n                    text('Disable') : $('#meetingHost').text('Enable');\n                (liveMeeting.participant_video == 0) ? $('#meetingParticipant').\n                    text('Disable') : $('#meetingParticipant').text('Enable');\n                isEmpty(liveMeeting.description) ? $('#meetingDescription').\n                    text('N/A') : $('#meetingDescription').\n                    text(liveMeeting.description);\n                $('#showModal').modal('show');\n            }\n        },\n        error: function (result) {\n            manageAjaxErrors(result);\n        },\n    });\n});\n\n$(document).on('click', '.edit-btn', function (event) {\n    if (ajaxCallIsRunning) {\n        return;\n    }\n    ajaxCallInProgress();\n    let liveMeetingId = $(event.currentTarget).data('id');\n    renderData(liveMeetingId);\n});\n\nwindow.renderData = function (id) {\n    $.ajax({\n        url: liveMeetingUrl + '/' + id + '/edit',\n        type: 'GET',\n        success: function (result) {\n            if (result.success) {\n                let liveMeeting = result.data;\n                $('#liveMeetingId').val(liveMeeting.id);\n                $('.edit-consultation-title').\n                    val(liveMeeting.consultation_title);\n                $('.edit-consultation-date').\n                    val(moment(liveMeeting.consultation_date).\n                        format('YYYY-MM-DD h:mm A'));\n                $('.edit-consultation-duration-minutes').\n                    val(liveMeeting.consultation_duration_minutes);\n                $('.editUserId').\n                    val(liveMeeting.meetingUsers).\n                    trigger('change.select2');\n                $('.host-enable,.host-disabled').prop('checked', false);\n                if (liveMeeting.host_video == 1) {\n                    $(`input[name=\"host_video\"][value=${liveMeeting.host_video}]`).\n                        prop('checked', true);\n                } else {\n                    $(`input[name=\"host_video\"][value=${liveMeeting.host_video}]`).\n                        prop('checked', true);\n                }\n                $('.client-enable,.client-disabled').prop('checked', false);\n                if (liveMeeting.participant_video == 1) {\n                    $(`input[name=\"participant_video\"][value=${liveMeeting.participant_video}]`).\n                        prop('checked', true);\n                } else {\n                    $(`input[name=\"participant_video\"][value=${liveMeeting.participant_video}]`).\n                        prop('checked', true);\n                }\n                $('.edit-description').val(liveMeeting.description);\n                $('#editModal').modal('show');\n                ajaxCallCompleted();\n            }\n        },\n        error: function (result) {\n            manageAjaxErrors(result);\n        },\n    });\n};\n\n$(document).on('submit', '#editForm', function (event) {\n    event.preventDefault();\n    let loadingButton = jQuery(this).find('#btnEditSave');\n    loadingButton.button('loading');\n    let id = $('#liveMeetingId').val();\n    $.ajax({\n        url: liveMeetingUrl + '/' + id,\n        type: 'post',\n        data: $(this).serialize(),\n        success: function (result) {\n            if (result.success) {\n                displaySuccessMessage(result.message);\n                $('#editModal').modal('hide');\n                $('#liveMeetingTable').\n                    DataTable().\n                    ajax.\n                    reload(null, false);\n            }\n        },\n        error: function (result) {\n            manageAjaxErrors(result);\n        },\n        complete: function () {\n            loadingButton.button('reset');\n        },\n    });\n});\n\n$(document).on('click', '.delete-btn', function (event) {\n    let liveMeetingId = $(event.currentTarget).data('id');\n    deleteItem(\n        liveMeetingUrl + '/' + liveMeetingId,\n        '#liveMeetingTable',\n        'Live Meeting',\n    );\n});\n\n$('#showModal').on('hidden.bs.modal', function () {\n    $(this).\n        find(\n            '#meetingTitle,#meetingDate, #meetingMinutes, #meetingHost, #meetingParticipant, #meetingDescription').\n        empty();\n});\n"],"sourceRoot":""}