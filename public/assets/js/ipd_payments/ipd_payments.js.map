{"version":3,"sources":["webpack:///./resources/assets/js/ipd_payments/ipd_payments.js"],"names":["deleteItemAjax","url","tableId","header","callFunction","$","ajax","type","dataType","success","obj","location","reload","swal","title","text","timer","eval","error","data","responseJSON","message","document","ready","tableName","DataTable","processing","serverSide","ipdPaymentUrl","id","ipdPatientDepartmentId","columnDefs","actionAcoumnVisibal","targets","defaultContent","columns","row","isEmpty","amount","getCurrentCurrencyClass","addCommas","name","render","date","moment","format","ipdPaymentModes","payment_mode","ipd_payment_document_url","downloadPaymetDocumentUrl","isPaymentModeStripe","prepareTemplateRender","datetimepicker","DatetimepickerDefaults","useCurrent","sideBySide","minDate","ipdPatientCaseDate","widgetPositioning","horizontal","vertical","select2","width","on","event","currentTarget","showCancelButton","closeOnConfirm","showLoaderOnConfirm","confirmButtonColor","cancelButtonColor","cancelButtonText","confirmButtonText","ajaxCallIsRunning","ajaxCallInProgress","ipdPaymentId","renderData","preventDefault","loadingButton","jQuery","this","find","button","formData","FormData","ipdPaymentCreateUrl","processData","contentType","result","displaySuccessMessage","modal","printErrorMessage","complete","window","ext","split","pop","toLowerCase","attr","pdfDocumentImageUrl","docxDocumentImageUrl","val","notes","trigger","ajaxCallCompleted","manageAjaxErrors","editIpdPaymentRecord","resetModalForm","defaultDocumentImageUrl","extension","isValidDocument","html","hide","displayDocument","inputSelector","validationMessageSelector","inArray","show","modalSelector","arguments","length","undefined","formSelector","UnprocessableInputError"],"mappings":"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","file":"/assets/js/ipd_payments/ipd_payments.js","sourcesContent":["$(document).ready(function () {\n    'use strict';\n\n    let tableName = '#tblIpdPayments';\n    $(tableName).DataTable({\n        processing: true,\n        serverSide: true,\n        'order': [[1, 'desc']],\n        ajax: {\n            url: ipdPaymentUrl,\n            data: function (data) {\n                data.id = ipdPatientDepartmentId;\n            },\n        },\n        columnDefs: [\n            {\n                'targets': [0, 1, 2],\n                'width': '10%',\n            },\n            {\n                'targets': [0],\n                'className': 'text-right',\n            },\n            {\n                'targets': [3],\n                'width': '5%',\n            },\n            {\n                'targets': [4],\n                'width': '20%',\n            },\n            {\n                'targets': [5],\n                'className': 'text-center',\n                'orderable': false,\n                'width': '4%',\n                'visible': actionAcoumnVisibal,\n            },\n            {\n                targets: '_all',\n                defaultContent: 'N/A',\n            },\n        ],\n        columns: [\n            {\n                data: function (row) {\n                    return !isEmpty(row.amount)\n                        ? '<p class=\"cur-margin\">' +\n                        getCurrentCurrencyClass() + ' ' +\n                        addCommas(row.amount) + '</p>'\n                        : 'N/A';\n                },\n                name: 'amount',\n            },\n            {\n                data: function (row) {\n                    return row;\n                },\n                render: function (row) {\n                    if (row.date === null) {\n                        return 'N/A';\n                    }\n\n                    return moment(row.date).format('Do MMM, Y h:mm A');\n                },\n                name: 'date',\n            },\n            {\n                data: function (row) {\n                    return ipdPaymentModes[row.payment_mode];\n                },\n                name: 'payment_mode',\n            },\n            {\n                data: function (row) {\n                    if (row.ipd_payment_document_url != '') {\n                        let downloadLink = downloadPaymetDocumentUrl + '/' +\n                            row.id;\n                        return '<a href=\"' + downloadLink + '\">' + 'Download' +\n                            '</a>';\n                    } else\n                        return 'N/A';\n                },\n                name: 'id',\n            },\n            {\n                data: 'notes',\n                name: 'notes',\n            },\n            {\n                data: function (row) {\n                    let isPaymentModeStripe = (row.payment_mode == 3)\n                        ? true\n                        : false;\n                    let data = [\n                        {\n                            'id': row.id,\n                            'isPaymentModeStripe': isPaymentModeStripe,\n                        }];\n                    return prepareTemplateRender('#ipdPaymentActionTemplate',\n                        data);\n                }, name: 'id',\n            },\n        ],\n    });\n    $('#ipdPaymentDate,#editIpdPaymentDate').\n        datetimepicker(DatetimepickerDefaults({\n            format: 'YYYY-MM-DD HH:mm:ss',\n            useCurrent: true,\n            sideBySide: true,\n            minDate: ipdPatientCaseDate,\n            widgetPositioning: {\n                horizontal: 'right',\n                vertical: 'bottom',\n            },\n        }));\n\n    $('#paymentModeId, #editPaymentModeId').select2({\n        width: '100%',\n    });\n\n    $(document).on('click', '.ipdpayment-delete-btn', function (event) {\n        let id = $(event.currentTarget).data('id');\n        let url = ipdPaymentUrl + '/' + id;\n        swal({\n            title: 'Delete !',\n            text: 'Are you sure want to delete this \" IPD Payment \" ?',\n            type: 'warning',\n            showCancelButton: true,\n            closeOnConfirm: false,\n            showLoaderOnConfirm: true,\n            confirmButtonColor: '#5cb85c',\n            cancelButtonColor: '#d33',\n            cancelButtonText: 'No',\n            confirmButtonText: 'Yes',\n        }, function () {\n            deleteItemAjax(url, tableName, 'IPD Payment');\n            location.reload();\n        });\n    });\n\n    $(document).on('click', '.ipdpayment-edit-btn', function (event) {\n        if (ajaxCallIsRunning) {\n            return;\n        }\n        ajaxCallInProgress();\n        let ipdPaymentId = $(event.currentTarget).data('id');\n        renderData(ipdPaymentId);\n    });\n\n    $(document).on('submit', '#addIpdPaymentNewForm', function (event) {\n        event.preventDefault();\n        let loadingButton = jQuery(this).find('#btnIpdPaymentSave');\n        loadingButton.button('loading');\n\n        var formData = new FormData($(this)[0]);\n        $.ajax({\n            url: ipdPaymentCreateUrl,\n            type: 'POST',\n            dataType: 'json',\n            data: formData,\n            processData: false,\n            contentType: false,\n            success: function success (result) {\n                if (result.success) {\n                    displaySuccessMessage(result.message);\n                    $('#addIpdPaymentModal').modal('hide');\n                    location.reload();\n                }\n            },\n            error: function error (result) {\n                printErrorMessage('#paymentValidationErrorsBox', result);\n            },\n            complete: function complete () {\n                loadingButton.button('reset');\n            },\n        });\n\n    });\n\n    window.renderData = function (id) {\n        $.ajax({\n            url: ipdPaymentUrl + '/' + id + '/edit',\n            type: 'GET',\n            success: function (result) {\n                if (result.success) {\n                    let ext = result.data.ipd_payment_document_url.split('.').\n                        pop().\n                        toLowerCase();\n                    if (ext == 'pdf') {\n                        $('#editPaymentPreviewImage').\n                            attr('src', pdfDocumentImageUrl);\n                    } else if ((ext == 'docx') || (ext == 'doc')) {\n                        $('#editPaymentPreviewImage').\n                            attr('src', docxDocumentImageUrl);\n                    } else {\n                        if (result.data.ipd_payment_document_url != '') {\n                            $('#editPaymentPreviewImage').\n                                attr('src',\n                                    result.data.ipd_payment_document_url);\n                        }\n                    }\n                    $('#ipdPaymentId').val(result.data.id);\n                    $('#editIpdPaymentAmount').val(result.data.amount);\n                    $('#editIpdPaymentDate').\n                        val(moment(result.data.date).\n                            format('YYYY-MM-DD HH:mm:ss'));\n                    $('#editIpdPaymentNote').val(result.data.notes);\n                    $('#editPaymentModeId').\n                        val(result.data.payment_mode).\n                        trigger('change.select2');\n                    $('#editIpdPaymentModal').modal('show');\n                    ajaxCallCompleted();\n                }\n            },\n            error: function (result) {\n                manageAjaxErrors(result);\n            },\n        });\n    };\n    $(document).on('submit', '#editIpdPaymentForm', function (event) {\n        event.preventDefault();\n        let loadingButton = jQuery(this).find('#btnIpdPaymentSave');\n        loadingButton.button('loading');\n        let id = $('#ipdPaymentId').val();\n        let url = ipdPaymentUrl + '/' + id;\n        let data = {\n            'formSelector': $(this),\n            'url': url,\n            'type': 'POST',\n            'tableSelector': tableName,\n        };\n        editIpdPaymentRecord(data, loadingButton, '#editIpdPaymentModal');\n\n    });\n\n    $('#addIpdPaymentModal').on('hidden.bs.modal', function () {\n        resetModalForm('#addIpdPaymentNewForm', '#paymentValidationErrorsBox');\n        $('#paymentPreviewImage').attr('src', defaultDocumentImageUrl);\n    });\n\n    $('#editIpdPaymentModal').on('hidden.bs.modal', function () {\n        resetModalForm('#editIpdPaymentForm',\n            '#editPaymentValidationErrorsBox');\n    });\n});\n\n$(document).on('change', '#paymentDocumentImage', function () {\n    let extension = isValidDocument($(this), '#paymentValidationErrorsBox');\n    if (!isEmpty(extension) && extension != false) {\n        $('#paymentValidationErrorsBox').html('').hide();\n        displayDocument(this, '#paymentPreviewImage', extension);\n    }\n});\n\n$(document).on('change', '#editPaymentDocumentImage', function () {\n    let extension = isValidDocument($(this), '#editPaymentValidationErrorsBox');\n    if (!isEmpty(extension) && extension != false) {\n        $('#editValidationErrorsBox').html('').hide();\n        displayDocument(this, '#editPaymentPreviewImage', extension);\n    }\n});\n\nwindow.isValidDocument = function (inputSelector, validationMessageSelector) {\n    let ext = $(inputSelector).val().split('.').pop().toLowerCase();\n    if ($.inArray(ext, ['png', 'jpg', 'jpeg', 'pdf', 'doc', 'docx']) == -1) {\n        $(inputSelector).val('');\n        $(validationMessageSelector).\n            html(\n                'The document must be a file of type: jpeg, jpg, png, pdf, doc, docx.').\n            show();\n        return false;\n    }\n    return ext;\n};\n\nfunction deleteItemAjax (url, tableId, header, callFunction = null) {\n    $.ajax({\n        url: url,\n        type: 'DELETE',\n        dataType: 'json',\n        success: function (obj) {\n            if (obj.success) {\n                location.reload();\n            }\n            swal({\n                title: 'Deleted!',\n                text: header + ' has been deleted.',\n                type: 'success',\n                timer: 2000,\n            });\n            if (callFunction) {\n                eval(callFunction);\n            }\n        },\n        error: function (data) {\n            swal({\n                title: '',\n                text: data.responseJSON.message,\n                type: 'error',\n                timer: 5000,\n            });\n        },\n    });\n}\n\nwindow.editIpdPaymentRecord = function (data, loadingButton) {\n    var modalSelector = arguments.length > 2 && arguments[2] !== undefined\n        ? arguments[2]\n        : '#EditModal';\n    var formData = data.formSelector === '' ? data.formData : new FormData(\n        $(data.formSelector)[0]);\n    $.ajax({\n        url: data.url,\n        type: data.type,\n        data: formData,\n        processData: false,\n        contentType: false,\n        success: function success (result) {\n            if (result.success) {\n                displaySuccessMessage(result.message);\n                $(modalSelector).modal('hide');\n                location.reload();\n            }\n        },\n        error: function error (result) {\n            UnprocessableInputError(result);\n        },\n        complete: function complete () {\n            loadingButton.button('reset');\n        },\n    });\n};\n"],"sourceRoot":""}