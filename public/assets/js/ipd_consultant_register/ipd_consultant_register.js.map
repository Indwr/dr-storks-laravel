{"version":3,"sources":["webpack:///./resources/assets/js/ipd_consultant_register/ipd_consultant_register.js"],"names":["$","document","ready","tableName","DataTable","processing","serverSide","ajax","url","ipdConsultantRegisterUrl","data","id","ipdPatientDepartmentId","columnDefs","targets","defaultContent","columns","row","render","applied_date","moment","format","name","doctorUrl","doctor_id","doctor","user","full_name","instruction_date","prepareTemplateRender","addDateTimePicker","datetimepicker","DatetimepickerDefaults","useCurrent","sideBySide","widgetPositioning","horizontal","vertical","minDate","ipdPatientCaseDate","dropdownToSelect2","selector","select2","placeholder","width","on","ipdConsultantItemHtml","append","uniqueId","resetIpdConsultantItemIndex","index","each","this","find","text","parents","remove","event","currentTarget","deleteItem","preventDefault","loadingButton","jQuery","button","ipdConsultantRegisterCreateUrl","newRecord","ajaxCallIsRunning","ajaxCallInProgress","ipdConsultantId","renderConsultantData","window","type","success","result","val","trigger","instruction","modal","ajaxCallCompleted","error","manageAjaxErrors","editRecord","resetModalForm"],"mappings":"AAAAA,EAAEC,UAAUC,OAAM,WACd,aAEA,IAAIC,EAAY,6BAChBH,EAAEG,GAAWC,UAAU,CACnBC,YAAY,EACZC,YAAY,EACZ,MAAS,CAAC,CAAC,EAAG,SACdC,KAAM,CACFC,IAAKC,yBACLC,KAAM,SAAUA,GACZA,EAAKC,GAAKC,yBAGlBC,WAAY,CACR,CACI,QAAW,CAAC,EAAG,EAAG,GAClB,MAAS,OAEb,CACI,QAAW,CAAC,GACZ,UAAa,cACb,WAAa,EACb,MAAS,MAEb,CACIC,QAAS,OACTC,eAAgB,QAGxBC,QAAS,CACL,CACIN,KAAM,SAAUO,GACZ,OAAOA,GAEXC,OAAQ,SAAUD,GACd,OAAyB,OAArBA,EAAIE,aACG,MAGJC,OAAOH,EAAIE,cAAcE,OAAO,qBAE3CC,KAAM,gBAEV,CACIZ,KAAM,SAAUO,GAEZ,MAAO,YADQM,UAAY,IAAMN,EAAIO,UACL,KAC5BP,EAAIQ,OAAOC,KAAKC,UAChB,QAERL,KAAM,0BAEV,CACIZ,KAAM,SAAUO,GACZ,OAAOA,GAEXC,OAAQ,SAAUD,GACd,OAA6B,OAAzBA,EAAIW,iBACG,MAGJR,OAAOH,EAAIW,kBAAkBP,OAAO,cAE/CC,KAAM,oBAEV,CACIZ,KAAM,SAAUO,GACZ,IAAIP,EAAO,CAAC,CAAE,GAAMO,EAAIN,KACxB,OAAOkB,sBACH,uCACAnB,IACLY,KAAM,4BAKrB,IAAMQ,EAAoB,WACtB9B,EAAE,gBAAgB+B,eAAeC,uBAAuB,CACpDX,OAAQ,sBACRY,YAAY,EACZC,YAAY,EACZC,kBAAmB,CACfC,WAAY,OACZC,SAAU,UAEdC,QAASC,sBAGbvC,EAAE,oBAAoB+B,eAAeC,uBAAuB,CACxDX,OAAQ,aACRY,YAAY,EACZC,YAAY,EACZC,kBAAmB,CACfC,WAAY,OACZC,SAAU,UAEdC,QAASC,uBAIjBT,IAEA,IAAMU,EAAoB,SAACC,GACvBzC,EAAEyC,GAAUC,QAAQ,CAChBC,YAAa,gBACbC,MAAO,UAIfJ,EAAkB,aAElBxC,EAAEC,UAAU4C,GAAG,QAAS,YAAY,WAChC,IAAInC,EAAO,CACP,QACA,UAEAoC,EAAwBjB,sBACxB,wCAAyCnB,GAC7CV,EAAE,kCAAkC+C,OAAOD,GAC3CN,EAAkB,aAClBV,IACAkB,WAEAC,OAGJ,IAAMA,EAA8B,WAChC,IAAIC,EAAQ,EAKZ,GAJAlD,EAAE,qCAAqCmD,MAAK,WACxCnD,EAAEoD,MAAMC,KAAK,gBAAgBC,KAAKJ,GAClCA,OAEAA,EAAQ,GAAK,EAAG,CAChB,IAAIxC,EAAO,CACP,QACA,UAEAoC,EAAwBjB,sBACxB,wCAAyCnB,GAC7CV,EAAE,kCAAkC+C,OAAOD,GAC3CN,EAAkB,aAClBQ,aAIRhD,EAAEC,UAAU4C,GAAG,QAAS,mCAAmC,WACvD7C,EAAEoD,MAAMG,QAAQ,MAAMC,SACtBP,OAGJjD,EAAEC,UAAU4C,GAAG,QAAS,0BAA0B,SAAUY,GACxD,IAAI9C,EAAKX,EAAEyD,EAAMC,eAAehD,KAAK,MACrCiD,WAAWlD,yBAA2B,IAAME,EAAIR,EAC5C,iCAGRH,EAAEC,UAAU4C,GAAG,SAAU,4BAA4B,SAAUY,GAC3DA,EAAMG,iBACN,IAAIC,EAAgBC,OAAOV,MAAMC,KAAK,yBACtCQ,EAAcE,OAAO,WACrB,IAAIrD,EAAO,CACP,aAAgBV,EAAEoD,MAClB,IAAOY,+BACP,KAAQ,OACR,cAAiB7D,GAErB8D,UAAUvD,EAAMmD,EAAe,qCAGnC7D,EAAEC,UAAU4C,GAAG,QAAS,wBAAwB,SAAUY,GACtD,IAAIS,kBAAJ,CAGAC,qBACA,IAAIC,EAAkBpE,EAAEyD,EAAMC,eAAehD,KAAK,MAClD2D,qBAAqBD,OAGzBE,OAAOD,qBAAuB,SAAU1D,GACpCX,EAAEO,KAAK,CACHC,IAAKC,yBAA2B,IAAME,EAAK,QAC3C4D,KAAM,MACNC,QAAS,SAAUC,GACXA,EAAOD,UACPxE,EAAE,wBAAwB0E,IAAID,EAAO/D,KAAKC,IAC1CX,EAAE,uBAAuB0E,IAAID,EAAO/D,KAAKS,cACzCnB,EAAE,iBACE0E,IAAID,EAAO/D,KAAKc,WAChBmD,QAAQ,kBACZ3E,EAAE,wBAAwB0E,IAAID,EAAO/D,KAAKkB,kBAC1C5B,EAAE,8BACE0E,IAAID,EAAO/D,KAAKkE,aACpB5E,EAAE,sCAAsC6E,MAAM,QAC9CC,sBAGRC,MAAO,SAAUN,GACbO,iBAAiBP,OAK7BzE,EAAEC,UAAU4C,GAAG,SAAU,6BAA6B,SAAUY,GAC5DA,EAAMG,iBACN,IAAIC,EAAgBC,OAAOV,MAAMC,KAAK,6BACtCQ,EAAcE,OAAO,WACrB,IAAIpD,EAAKX,EAAE,wBAAwB0E,MAC/BlE,EAAMC,yBAA2B,IAAME,EACvCD,EAAO,CACP,aAAgBV,EAAEoD,MAClB,IAAO5C,EACP,KAAQ,OACR,cAAiBL,GAErB8E,WAAWvE,EAAMmD,EAAe,yCAGpC7D,EAAE,kCAAkC6C,GAAG,mBAAmB,WACtDqC,eAAe,2BAA4B,wBAC3ClF,EAAE,gCAAgCqD,KAAK,YAAYG,SACnDxD,EAAE,aAAa0E,IAAI,IACnB1E,EAAE,aAAa2E,QAAQ","file":"/assets/js/ipd_consultant_register/ipd_consultant_register.js","sourcesContent":["$(document).ready(function () {\n    'use strict';\n\n    let tableName = '#tblIpdConsultantRegisters';\n    $(tableName).DataTable({\n        processing: true,\n        serverSide: true,\n        'order': [[0, 'desc']],\n        ajax: {\n            url: ipdConsultantRegisterUrl,\n            data: function (data) {\n                data.id = ipdPatientDepartmentId;\n            },\n        },\n        columnDefs: [\n            {\n                'targets': [0, 1, 2],\n                'width': '10%',\n            },\n            {\n                'targets': [3],\n                'className': 'text-center',\n                'orderable': false,\n                'width': '4%',\n            },\n            {\n                targets: '_all',\n                defaultContent: 'N/A',\n            },\n        ],\n        columns: [\n            {\n                data: function (row) {\n                    return row;\n                },\n                render: function (row) {\n                    if (row.applied_date === null) {\n                        return 'N/A';\n                    }\n\n                    return moment(row.applied_date).format('Do MMM, Y h:mm A');\n                },\n                name: 'applied_date',\n            },\n            {\n                data: function (row) {\n                    let showLink = doctorUrl + '/' + row.doctor_id;\n                    return '<a href=\"' + showLink + '\">' +\n                        row.doctor.user.full_name +\n                        '</a>';\n                },\n                name: 'doctor.user.first_name',\n            },\n            {\n                data: function (row) {\n                    return row;\n                },\n                render: function (row) {\n                    if (row.instruction_date === null) {\n                        return 'N/A';\n                    }\n\n                    return moment(row.instruction_date).format('Do MMM, Y');\n                },\n                name: 'instruction_date',\n            },\n            {\n                data: function (row) {\n                    let data = [{ 'id': row.id }];\n                    return prepareTemplateRender(\n                        '#ipdConsultantRegisterActionTemplate',\n                        data);\n                }, name: 'doctor.user.last_name',\n            },\n        ],\n    });\n\n    const addDateTimePicker = () => {\n        $('.appliedDate').datetimepicker(DatetimepickerDefaults({\n            format: 'YYYY-MM-DD HH:mm:ss',\n            useCurrent: false,\n            sideBySide: true,\n            widgetPositioning: {\n                horizontal: 'left',\n                vertical: 'bottom',\n            },\n            minDate: ipdPatientCaseDate,\n        }));\n\n        $('.instructionDate').datetimepicker(DatetimepickerDefaults({\n            format: 'YYYY-MM-DD',\n            useCurrent: false,\n            sideBySide: true,\n            widgetPositioning: {\n                horizontal: 'left',\n                vertical: 'bottom',\n            },\n            minDate: ipdPatientCaseDate,\n        }));\n    };\n\n    addDateTimePicker();\n\n    const dropdownToSelect2 = (selector) => {\n        $(selector).select2({\n            placeholder: 'Select Doctor',\n            width: '100%',\n        });\n    };\n\n    dropdownToSelect2('.doctorId');\n\n    $(document).on('click', '#addItem', function () {\n        let data = {\n            'doctors': doctors,\n            'uniqueId': uniqueId,\n        };\n        let ipdConsultantItemHtml = prepareTemplateRender(\n            '#ipdConsultantInstructionItemTemplate', data);\n        $('.ipd-consultant-item-container').append(ipdConsultantItemHtml);\n        dropdownToSelect2('.doctorId');\n        addDateTimePicker();\n        uniqueId++;\n\n        resetIpdConsultantItemIndex();\n    });\n\n    const resetIpdConsultantItemIndex = () => {\n        let index = 1;\n        $('.ipd-consultant-item-container>tr').each(function () {\n            $(this).find('.item-number').text(index);\n            index++;\n        });\n        if (index - 1 == 0) {\n            let data = {\n                'doctors': doctors,\n                'uniqueId': uniqueId,\n            };\n            let ipdConsultantItemHtml = prepareTemplateRender(\n                '#ipdConsultantInstructionItemTemplate', data);\n            $('.ipd-consultant-item-container').append(ipdConsultantItemHtml);\n            dropdownToSelect2('.doctorId');\n            uniqueId++;\n        }\n    };\n\n    $(document).on('click', '.deleteIpdConsultantInstruction', function () {\n        $(this).parents('tr').remove();\n        resetIpdConsultantItemIndex();\n    });\n\n    $(document).on('click', '.delete-consultant-btn', function (event) {\n        let id = $(event.currentTarget).data('id');\n        deleteItem(ipdConsultantRegisterUrl + '/' + id, tableName,\n            'IPD Consultant Instruction');\n    });\n\n    $(document).on('submit', '#addIpdConsultantNewForm', function (event) {\n        event.preventDefault();\n        let loadingButton = jQuery(this).find('#btnIpdConsultantSave');\n        loadingButton.button('loading');\n        let data = {\n            'formSelector': $(this),\n            'url': ipdConsultantRegisterCreateUrl,\n            'type': 'POST',\n            'tableSelector': tableName,\n        };\n        newRecord(data, loadingButton, '#addConsultantInstructionModal');\n    });\n\n    $(document).on('click', '.edit-consultant-btn', function (event) {\n        if (ajaxCallIsRunning) {\n            return;\n        }\n        ajaxCallInProgress();\n        let ipdConsultantId = $(event.currentTarget).data('id');\n        renderConsultantData(ipdConsultantId);\n    });\n\n    window.renderConsultantData = function (id) {\n        $.ajax({\n            url: ipdConsultantRegisterUrl + '/' + id + '/edit',\n            type: 'GET',\n            success: function (result) {\n                if (result.success) {\n                    $('#ipdEditConsultantId').val(result.data.id);\n                    $('#ipdEditAppliedDate').val(result.data.applied_date);\n                    $('#editDoctorId').\n                        val(result.data.doctor_id).\n                        trigger('change.select2');\n                    $('#editInstructionDate').val(result.data.instruction_date);\n                    $('#editConsultantInstruction').\n                        val(result.data.instruction);\n                    $('#editIpdConsultantInstructionModal').modal('show');\n                    ajaxCallCompleted();\n                }\n            },\n            error: function (result) {\n                manageAjaxErrors(result);\n            },\n        });\n    };\n\n    $(document).on('submit', '#editIpdConsultantNewForm', function (event) {\n        event.preventDefault();\n        let loadingButton = jQuery(this).find('#btnEditIpdConsultantSave');\n        loadingButton.button('loading');\n        let id = $('#ipdEditConsultantId').val();\n        let url = ipdConsultantRegisterUrl + '/' + id;\n        let data = {\n            'formSelector': $(this),\n            'url': url,\n            'type': 'POST',\n            'tableSelector': tableName,\n        };\n        editRecord(data, loadingButton, '#editIpdConsultantInstructionModal');\n    });\n\n    $('#addConsultantInstructionModal').on('hidden.bs.modal', function () {\n        resetModalForm('#addIpdConsultantNewForm', '#validationErrorsBox');\n        $('#ipdConsultantInstructionTbl').find('tr:gt(1)').remove();\n        $('.doctorId').val('');\n        $('.doctorId').trigger('change');\n    });\n});\n"],"sourceRoot":""}