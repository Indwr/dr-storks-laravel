{"version":3,"sources":["webpack:///./resources/assets/js/insurances/create-edit.js"],"names":["$","document","ready","resetInvoiceItemIndex","index","each","this","find","text","append","trigger","discount","val","blur","length","focus","window","isNumberKey","evt","element","charCode","which","event","keyCode","indexOf","on","data","diseaseItemHtml","prepareTemplateRender","uniqueId","parents","remove","calculateAndSetInvoiceAmount","totalAmount","serviceTax","parseInt","removeCommas","hospitalRate","parseFloat","itemTotal","addCommas","toFixed","preventDefault","screenLock","attr","loadingButton","jQuery","button","formData","FormData","ajax","url","insuranceSaveUrl","type","dataType","processData","contentType","success","result","displaySuccessMessage","message","location","href","insuranceUrl","error","printErrorMessage","complete","screenUnLock"],"mappings":"AAAAA,EAAEC,UAAUC,OAAM,WACd,aAwCA,SAASC,IACL,IAAIC,EAAQ,EACZJ,EAAE,8BAA8BK,MAAK,WACjCL,EAAEM,MAAMC,KAAK,gBAAgBC,KAAKJ,GAClCA,OAEAA,EAAQ,GAAK,IACbJ,EAAE,UAAUQ,KAAK,KACjBR,EAAE,kBAAkBS,OAAO,6VA9CnCT,EAAE,gBAAgBU,QAAQ,SAEtBC,SAAW,GACXX,EAAE,aAAaY,IAAI,GAEvBZ,EAAE,eAAea,MAAK,WACmB,GAAjCb,EAAE,eAAeY,MAAME,QACvBd,EAAE,eAAeY,IAAI,MAI7BZ,EAAE,kBAAkBO,KAAK,4BAA4BQ,QAErDC,OAAOC,YAAc,SAACC,EAAKC,GACvB,IAAIC,EAAYF,EAAIG,MAASH,EAAIG,MAAQC,MAAMC,QAE/C,SAAuB,KAAbH,IAAsD,IAAnCpB,EAAEmB,GAASP,MAAMY,QAAQ,QACjDJ,EAAW,IAAMA,EAAW,MAGrCpB,EAAEC,UAAUwB,GAAG,QAAS,YAAY,WAChC,IAAIC,EAAO,CACP,UAEAC,EAAkBC,sBAClB,4BAA6BF,GACjC1B,EAAE,2BAA2BS,OAAOkB,GACpCE,WAEA1B,OAGJH,EAAEC,UAAUwB,GAAG,QAAS,mBAAmB,WACvCzB,EAAEM,MAAMwB,QAAQ,MAAMC,SACtB5B,IACA6B,kCAoBJhC,EAAEC,UACEwB,GAAG,SAAU,4DACT,WACIO,kCAGZhB,OAAOgB,6BAA+B,WAClC,IAAIC,EAAc,EACdC,EAAaC,SACe,KAA5BnC,EAAE,gBAAgBY,MAAewB,aAC7BpC,EAAE,gBAAgBY,OAAS,GAC/ByB,EAAeF,SACe,KAA9BnC,EAAE,kBAAkBY,MAAewB,aAC/BpC,EAAE,kBAAkBY,OAAS,GACjCD,EAAW2B,WAAWtC,EAAE,aAAaY,OACzCqB,EAAcC,EAAaG,EAC3BrC,EAAE,8BAA8BK,MAAK,WACjC,IAAIkC,EAAYJ,SAC6B,IAAzCnC,EAAEM,MAAMC,KAAK,mBAAmBK,MAAcwB,aAC1CpC,EAAEM,MAAMC,KAAK,mBAAmBK,OAAS,GACjDqB,GAAeM,KAEnBN,GAAgBA,EAActB,EAAW,IAEzCX,EAAE,UAAUQ,KAAKgC,UAAUP,EAAYQ,QAAQ,KAC/CzC,EAAE,iBAAiBY,IAAIqB,IAG3BjC,EAAEC,UAAUwB,GAAG,SAAU,kBAAkB,SAAUH,GACjDA,EAAMoB,iBACNC,aACA3C,EAAE,YAAY4C,KAAK,YAAY,GAC/B,IAAIC,EAAgBC,OAAOxC,MAAMC,KAAK,YACtCsC,EAAcE,OAAO,WACrB,IAAIC,EAAW,IAAIC,SAASjD,EAAEM,MAAM,IACpCN,EAAEkD,KAAK,CACHC,IAAKC,iBACLC,KAAM,OACNC,SAAU,OACV5B,KAAMsB,EACNO,aAAa,EACbC,aAAa,EACbC,QAAS,SAAUC,GACfC,sBAAsBD,EAAOE,SAC7B5C,OAAO6C,SAASC,KAAOC,cAE3BC,MAAO,SAAUN,GACbO,kBAAkB,uBAAwBP,GAC1C1D,EAAE,YAAY4C,KAAK,YAAY,IAEnCsB,SAAU,WACNC,eACAtB,EAAcE,OAAO","file":"/assets/js/insurances/create-edit.js","sourcesContent":["$(document).ready(function () {\n    'use strict';\n\n    $('.price-input').trigger('input');\n\n    if (discount < 0) {\n        $('.discount').val(0);\n    }\n    $('#discountId').blur(function () {\n        if ($('#discountId').val().length == 0) {\n            $('#discountId').val(0);\n        }\n    });\n\n    $('#insuranceForm').find('input:text:visible:first').focus();\n\n    window.isNumberKey = (evt, element) => {\n        let charCode = (evt.which) ? evt.which : event.keyCode;\n\n        return !((charCode !== 46 || $(element).val().indexOf('.') !== -1) &&\n            (charCode < 48 || charCode > 57));\n    };\n\n    $(document).on('click', '#addItem', function () {\n        let data = {\n            'uniqueId': uniqueId,\n        };\n        let diseaseItemHtml = prepareTemplateRender(\n            '#insuranceDiseaseTemplate', data);\n        $('.disease-item-container').append(diseaseItemHtml);\n        uniqueId++;\n\n        resetInvoiceItemIndex();\n    });\n\n    $(document).on('click', '.delete-disease', function () {\n        $(this).parents('tr').remove();\n        resetInvoiceItemIndex();\n        calculateAndSetInvoiceAmount();\n    });\n\n    function resetInvoiceItemIndex () {\n        let index = 1;\n        $('.disease-item-container>tr').each(function () {\n            $(this).find('.item-number').text(index);\n            index++;\n        });\n        if (index - 1 == 0) {\n            $('#total').text('0');\n            $('#billTbl tbody').append('<tr>' +\n                '<td class=\"text-center item-number\">1</td>' +\n                '<td><input class=\"form-control disease-name\" required name=\"disease_name[]\" type=\"text\"></td>' +\n                '<td><input class=\"form-control disease-charge price-input\" required name=\"disease_charge[]\" type=\"text\"></td>' +\n                '<td class=\"text-center\"><i class=\"fa fa-trash text-danger delete-disease pointer\"></i></td>' +\n                '</tr>');\n        }\n    }\n\n    $(document).\n        on('change', '.service-tax, .discount, .hospital-rate, .disease-charge',\n            function () {\n                calculateAndSetInvoiceAmount();\n            });\n\n    window.calculateAndSetInvoiceAmount = function () {\n        let totalAmount = 0;\n        let serviceTax = parseInt(\n            $('.service-tax').val() !== '' ? removeCommas(\n                $('.service-tax').val()) : 0);\n        let hospitalRate = parseInt(\n            $('.hospital-rate').val() !== '' ? removeCommas(\n                $('.hospital-rate').val()) : 0);\n        let discount = parseFloat($('.discount').val());\n        totalAmount = serviceTax + hospitalRate;\n        $('.disease-item-container>tr').each(function () {\n            let itemTotal = parseInt(\n                $(this).find('.disease-charge').val() != '' ? removeCommas(\n                    $(this).find('.disease-charge').val()) : 0);\n            totalAmount += itemTotal;\n        });\n        totalAmount -= (totalAmount * discount / 100);\n\n        $('#total').text(addCommas(totalAmount.toFixed(2)));\n        $('#total_amount').val(totalAmount);\n    };\n\n    $(document).on('submit', '#insuranceForm', function (event) {\n        event.preventDefault();\n        screenLock();\n        $('#saveBtn').attr('disabled', true);\n        let loadingButton = jQuery(this).find('#saveBtn');\n        loadingButton.button('loading');\n        let formData = new FormData($(this)[0]);\n        $.ajax({\n            url: insuranceSaveUrl,\n            type: 'POST',\n            dataType: 'json',\n            data: formData,\n            processData: false,\n            contentType: false,\n            success: function (result) {\n                displaySuccessMessage(result.message);\n                window.location.href = insuranceUrl;\n            },\n            error: function (result) {\n                printErrorMessage('#validationErrorsBox', result);\n                $('#saveBtn').attr('disabled', false);\n            },\n            complete: function () {\n                screenUnLock();\n                loadingButton.button('reset');\n            },\n        });\n    });\n});\n"],"sourceRoot":""}