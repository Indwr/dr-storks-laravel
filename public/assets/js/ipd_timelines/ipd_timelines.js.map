{"version":3,"sources":["webpack:///./resources/assets/js/ipd_timelines/ipd_timelines.js"],"names":["$","document","ready","getIpdTimelines","val","datetimepicker","DatetimepickerDefaults","format","useCurrent","sideBySide","minDate","ipdPatientCaseDate","on","e","preventDefault","loadingButton","jQuery","this","find","button","data","ipdTimelineCreateUrl","newRecord","setTimeout","ajaxCallIsRunning","ajaxCallInProgress","ipdTimelineId","renderTimelineData","window","id","ajax","url","ipdTimelinesUrl","type","success","result","ipd_timeline_document_url","ext","split","pop","toLowerCase","attr","pdfDocumentImageUrl","docxDocumentImageUrl","show","hide","defaultDocumentImageUrl","title","date","description","visible_to_person","prop","modal","ajaxCallCompleted","error","manageAjaxErrors","event","editRecord","location","reload","deleteIpdTimelineItem","header","swal","text","showCancelButton","closeOnConfirm","showLoaderOnConfirm","confirmButtonColor","cancelButtonColor","cancelButtonText","confirmButtonText","dataType","obj","timer","responseJSON","message","resetModalForm","extension","isValidTimelineDocument","isEmpty","html","displayDocument","inputSelector","validationMessageSelector","inArray","ipdPatientDepartmentId"],"mappings":"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","file":"/assets/js/ipd_timelines/ipd_timelines.js","sourcesContent":["$(document).ready(function () {\n    'use strict';\n\n    getIpdTimelines($('#ipdPatientDepartmentId').val());\n\n    $('#timelineDate, #editTimelineDate').\n        datetimepicker(DatetimepickerDefaults({\n            format: 'YYYY-MM-DD',\n            useCurrent: true,\n            sideBySide: true,\n            minDate: ipdPatientCaseDate,\n        }));\n\n    $(document).on('submit', '#addIpdTimelineNewForm', function (e) {\n        e.preventDefault();\n        let loadingButton = jQuery(this).find('#btnIpdTimelineSave');\n        loadingButton.button('loading');\n        let data = {\n            'formSelector': $(this),\n            'url': ipdTimelineCreateUrl,\n            'type': 'POST',\n            'tableSelector': '#tbl',\n        };\n        newRecord(data, loadingButton, '#addIpdTimelineModal');\n        setTimeout(function () {\n            getIpdTimelines($('#ipdPatientDepartmentId').val());\n        }, 500);\n    });\n\n    $(document).on('click', '.edit-timeline-btn', function () {\n        if (ajaxCallIsRunning) {\n            return;\n        }\n        ajaxCallInProgress();\n        let ipdTimelineId = $(this).data('timeline-id');\n        renderTimelineData(ipdTimelineId);\n    });\n\n    window.renderTimelineData = function (id) {\n        $.ajax({\n            url: ipdTimelinesUrl + '/' + id + '/edit',\n            type: 'GET',\n            success: function (result) {\n                if (result.success) {\n                    if (result.data.ipd_timeline_document_url != '') {\n                        let ext = result.data.ipd_timeline_document_url.split(\n                            '.').\n                            pop().\n                            toLowerCase();\n                        if (ext == 'pdf') {\n                            $('#editPreviewTimelineImage').\n                                attr('src', pdfDocumentImageUrl);\n                        } else if ((ext == 'docx') || (ext == 'doc')) {\n                            $('#editPreviewTimelineImage').\n                                attr('src', docxDocumentImageUrl);\n                        } else {\n                            $('#editPreviewTimelineImage').\n                                attr('src',\n                                    result.data.ipd_timeline_document_url);\n                        }\n                        $('#timeDocumentUrl').show();\n                    } else {\n                        $('#timeDocumentUrl').hide();\n                        $('#editPreviewTimelineImage').\n                            attr('src', defaultDocumentImageUrl);\n                    }\n                    $('#ipdTimelineId').val(result.data.id);\n                    $('#editTimelineTitle').val(result.data.title);\n                    $('#editTimelineDate').val(result.data.date);\n                    $('#editTimelineDescription').val(result.data.description);\n                    $('#timeDocumentUrl').\n                        attr('href', result.data.ipd_timeline_document_url);\n                    (result.data.visible_to_person == 1)\n                        ? $('#editTimelineVisibleToPerson').\n                            prop('checked', true)\n                        : $('#editTimelineVisibleToPerson').\n                            prop('checked', false);\n                    $('#editIpdTimelineModal').modal('show');\n                    ajaxCallCompleted();\n                }\n            },\n            error: function (result) {\n                manageAjaxErrors(result);\n            },\n        });\n    };\n\n    $(document).on('submit', '#editIpdTimelineForm', function (event) {\n        event.preventDefault();\n        let loadingButton = jQuery(this).find('#btnIpdTimelineEdit');\n        loadingButton.button('loading');\n        let id = $('#ipdTimelineId').val();\n        let url = ipdTimelinesUrl + '/' + id;\n        let data = {\n            'formSelector': $(this),\n            'url': url,\n            'type': 'POST',\n            'tableSelector': '#tbl',\n        };\n        editRecord(data, loadingButton, '#editIpdTimelineModal');\n        setTimeout(function () {\n            location.reload();\n        }, 500);\n    });\n\n    $(document).on('click', '.delete-timeline-btn', function () {\n        let id = $(this).data('timeline-id');\n        deleteIpdTimelineItem(ipdTimelinesUrl + '/' + id, 'IPD Timeline');\n    });\n\n    window.deleteIpdTimelineItem = function (url, header) {\n        swal({\n                title: 'Delete !',\n                text: 'Are you sure want to delete this \"' + header + '\" ?',\n                type: 'warning',\n                showCancelButton: true,\n                closeOnConfirm: false,\n                showLoaderOnConfirm: true,\n                confirmButtonColor: '#5cb85c',\n                cancelButtonColor: '#d33',\n                cancelButtonText: 'No',\n                confirmButtonText: 'Yes',\n            },\n            function () {\n                $.ajax({\n                    url: url,\n                    type: 'DELETE',\n                    dataType: 'json',\n                    success: function (obj) {\n                        if (obj.success) {\n                            setTimeout(function () {\n                                getIpdTimelines(\n                                    $('#ipdPatientDepartmentId').val());\n                            }, 500);\n                        }\n                        swal({\n                            title: 'Deleted!',\n                            text: header + ' has been deleted.',\n                            type: 'success',\n                            timer: 2000,\n                        });\n                    },\n                    error: function (data) {\n                        swal({\n                            title: '',\n                            text: data.responseJSON.message,\n                            type: 'error',\n                            timer: 5000,\n                        });\n                    },\n                });\n            });\n    };\n\n    $('#addIpdTimelineModal').on('hidden.bs.modal', function () {\n        resetModalForm('#addIpdTimelineNewForm', '#validationErrorsBox');\n        $('#previewTimelineImage').attr('src', defaultDocumentImageUrl);\n    });\n\n    $('#editIpdTimelineModal').on('hidden.bs.modal', function () {\n        resetModalForm('#editIpdTimelineForm', '#editValidationErrorsBox');\n    });\n});\n\n$(document).on('change', '#timelineDocumentImage', function () {\n    let extension = isValidTimelineDocument($(this), '#validationErrorsBox');\n    if (!isEmpty(extension) && extension != false) {\n        $('#validationErrorsBox').html('').hide();\n        displayDocument(this, '#previewTimelineImage', extension);\n    }\n});\n\n$(document).on('change', '#editTimelineDocumentImage', function () {\n    let extension = isValidTimelineDocument($(this),\n        '#editValidationErrorsBox');\n    if (!isEmpty(extension) && extension != false) {\n        $('#editValidationErrorsBox').html('').hide();\n        displayDocument(this, '#editPreviewTimelineImage', extension);\n    }\n});\n\nwindow.isValidTimelineDocument = function (\n    inputSelector, validationMessageSelector) {\n    let ext = $(inputSelector).val().split('.').pop().toLowerCase();\n    if ($.inArray(ext, ['png', 'jpg', 'jpeg', 'pdf', 'doc', 'docx']) == -1) {\n        $(inputSelector).val('');\n        $(validationMessageSelector).\n            html(\n                'The document must be a file of type: jpeg, jpg, png, pdf, doc, docx.').\n            show();\n        return false;\n    }\n    return ext;\n};\n\nwindow.getIpdTimelines = function (ipdPatientDepartmentId) {\n    $.ajax({\n        url: ipdTimelinesUrl,\n        type: 'get',\n        data: { id: ipdPatientDepartmentId },\n        success: function (data) {\n            $('#ipdTimelines').html(data);\n        },\n    });\n};\n"],"sourceRoot":""}