{"version":3,"sources":["webpack:///./resources/assets/js/enquiry/enquiry.js"],"names":["$","document","ready","select2","width","tbl","DataTable","processing","serverSide","ajax","url","enquiryUrl","data","status","find","val","columnDefs","columns","name","row","console","log","enquiry_type","render","created_at","moment","utc","format","viewed_by","user","full_name","checked","id","prepareTemplateRender","showLink","enquiryShowUrl","change","reload","on","event","enquiryId","currentTarget","updateStatus","window","method","cache","success","result"],"mappings":"AAAAA,EAAEC,UAAUC,OAAM,WACd,aAEAF,EAAE,wBAAwBG,QAAQ,CAC9BC,MAAO,SAGX,IACIC,EAAML,EAAE,mBAAmBM,UAAU,CACrCC,YAAY,EACZC,YAAY,EACZ,MAAS,CAAC,CAAC,EAAG,SACdC,KAAM,CACFC,IAAKC,WACLC,KAAM,SAAUA,GACZA,EAAKC,OAASb,EAAE,kBACZc,KAAK,mBACLC,QAGZC,WAAY,CACR,CACI,QAAW,CAAC,GACZ,WAAa,EACb,UAAa,cACb,MAAS,MAEb,CACI,QAAW,CAAC,GACZ,WAAa,EACb,UAAa,cACb,MAAS,MAEb,CACI,QAAW,CAAC,GACZ,MAAS,OAEb,CACI,QAAW,CAAC,EAAG,GACf,MAAS,OAEb,CACI,YAAc,EACd,WAAa,EACb,QAAW,IAGnBC,QAAS,CACL,CACIL,KAAM,YACNM,KAAM,aAEV,CACIN,KAAM,QACNM,KAAM,SAEV,CACIN,KAAM,SAAUO,GAEZ,OADAC,QAAQC,IAAIF,GACLA,EAAIG,cAEfJ,KAAM,QAEV,CACIN,KAAM,SAAUO,GACZ,OAAOA,GAEXI,OAAQ,SAAUJ,GACd,OAAuB,OAAnBA,EAAIK,WACG,MAGJC,OAAON,EAAIK,YACdE,MACAC,OAAO,qBAEfT,KAAM,cAEV,CACIN,KAAM,SAAUO,GACZ,OAAsB,OAAlBA,EAAIS,UACG,aAEAT,EAAIU,KAAKC,WAExBZ,KAAM,mBAEV,CACIN,KAAM,SAAUO,GACZ,IAAIY,EAAwB,GAAdZ,EAAIN,OAAc,GAAK,UACjCD,EAAO,CAAC,CAAE,GAAMO,EAAIa,GAAI,QAAWD,IACvC,OAAOE,sBAAsB,yBACzBrB,IAERM,KAAM,UAEV,CACIN,KAAM,SAAUO,GACZ,IAAIe,EAAWC,eAAiB,IAAMhB,EAAIa,GACtCpB,EAAO,CACP,CACI,GAAMO,EAAIa,GACV,IAAOE,IAEf,OAAOD,sBAAsB,yBACzBrB,IACLM,KAAM,mBAGjB,eAAkB,WACdlB,EAAE,kBAAkBoC,QAAO,WACvBpC,EAxGI,mBAwGSM,YAAYG,KAAK4B,OAAO,MAAM,SAKvDrC,EAAEC,UAAUqC,GAAG,SAAU,WAAW,SAAUC,GAC1C,IAAIC,EAAYxC,EAAEuC,EAAME,eAAe7B,KAAK,MAC5C8B,aAAaF,MAGjBG,OAAOD,aAAe,SAAUV,GAC5BhC,EAAES,KAAK,CACHC,IAAKC,WAAa,MAAOqB,EAAK,mBAC9BY,OAAQ,OACRC,OAAO,EACPC,QAAS,SAAUC,GACXA,EAAOD,SACPzC,EAAII,KAAK4B,OAAO,MAAM","file":"/assets/js/enquiry/enquiry.js","sourcesContent":["$(document).ready(function () {\n    'use strict';\n\n    $('#type,#filter_status').select2({\n        width: '100%',\n    });\n\n    let tableName = '#enquiriesTable';\n    let tbl = $('#enquiriesTable').DataTable({\n        processing: true,\n        serverSide: true,\n        'order': [[0, 'desc']],\n        ajax: {\n            url: enquiryUrl,\n            data: function (data) {\n                data.status = $('#filter_status').\n                    find('option:selected').\n                    val();\n            },\n        },\n        columnDefs: [\n            {\n                'targets': [5],\n                'orderable': false,\n                'className': 'text-center',\n                'width': '4%',\n            },\n            {\n                'targets': [6],\n                'orderable': false,\n                'className': 'text-center',\n                'width': '8%',\n            },\n            {\n                'targets': [0],\n                'width': '20%',\n            },\n            {\n                'targets': [1, 2],\n                'width': '15%',\n            },\n            {\n                'searchable': true,\n                'orderable': true,\n                'targets': 2,\n            },\n        ],\n        columns: [\n            {\n                data: 'full_name',\n                name: 'full_name',\n            },\n            {\n                data: 'email',\n                name: 'email',\n            },\n            {\n                data: function (row) {\n                    console.log(row);\n                    return row.enquiry_type;\n                },\n                name: 'type',\n            },\n            {\n                data: function (row) {\n                    return row;\n                },\n                render: function (row) {\n                    if (row.created_at === null) {\n                        return 'N/A';\n                    }\n\n                    return moment(row.created_at).\n                        utc().\n                        format('Do MMM, Y h:mm A');\n                },\n                name: 'created_at',\n            },\n            {\n                data: function (row) {\n                    if (row.viewed_by === null)\n                        return 'Not viewed';\n                    else\n                        return row.user.full_name;\n                },\n                name: 'user.first_name',\n            },\n            {\n                data: function (row) {\n                    let checked = row.status == 0 ? '' : 'checked';\n                    let data = [{ 'id': row.id, 'checked': checked }];\n                    return prepareTemplateRender('#enquiryStatusTemplate',\n                        data);\n                },\n                name: 'status',\n            },\n            {\n                data: function (row) {\n                    let showLink = enquiryShowUrl + '/' + row.id;\n                    let data = [\n                        {\n                            'id': row.id,\n                            'url': showLink,\n                        }];\n                    return prepareTemplateRender('#enquiryActionTemplate',\n                        data);\n                }, name: 'user.last_name',\n            },\n        ],\n        'fnInitComplete': function () {\n            $('#filter_status').change(function () {\n                $(tableName).DataTable().ajax.reload(null, true);\n            });\n        },\n    });\n\n    $(document).on('change', '.status', function (event) {\n        let enquiryId = $(event.currentTarget).data('id');\n        updateStatus(enquiryId);\n    });\n\n    window.updateStatus = function (id) {\n        $.ajax({\n            url: enquiryUrl + '/' + +id + '/active-deactive',\n            method: 'post',\n            cache: false,\n            success: function (result) {\n                if (result.success) {\n                    tbl.ajax.reload(null, false);\n                }\n            },\n        });\n    };\n\n});\n"],"sourceRoot":""}