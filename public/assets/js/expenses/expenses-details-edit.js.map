{"version":3,"sources":["webpack:///./resources/assets/js/expenses/expenses-details-edit.js"],"names":["$","document","ready","on","focus","select2","width","datetimepicker","DatetimepickerDefaults","format","useCurrent","sideBySide","event","ajaxCallIsRunning","ajaxCallInProgress","expenseId","currentTarget","data","renderData","window","id","ajax","url","expenseUrl","type","success","result","ext","document_url","split","pop","toLowerCase","attr","pdfDocumentImageUrl","docxDocumentImageUrl","defaultDocumentImageUrl","val","expense_head","trigger","name","date","invoice_number","amount","description","isEmpty","text","html","modal","ajaxCallCompleted","error","manageAjaxErrors","preventDefault","loadingButton","jQuery","this","find","button","editExpenseRecord","modalSelector","btnToDisabledSelector","formData","formSelector","FormData","processData","contentType","displaySuccessMessage","message","setTimeout","location","reload","UnprocessableInputError","complete","resetModalForm","extension","isValidDocument","hide","displayDocument","inputSelector","validationMessageSelector","inArray","documentError","show"],"mappings":"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","file":"/assets/js/expenses/expenses-details-edit.js","sourcesContent":["$(document).ready(function () {\n    'use strict';\n\n    $('#addModal, #EditModal').on('shown.bs.modal', function () {\n        $('#expenseId, #editExpenseHeadId:first').focus();\n    });\n\n    $('#expenseId, #editExpenseHeadId,#expenseHead').select2({\n        width: '100%',\n    });\n\n    $('#date, #editDate').datetimepicker(DatetimepickerDefaults({\n        format: 'YYYY-MM-DD',\n        useCurrent: true,\n        sideBySide: true,\n    }));\n\n    $(document).on('click', '.edit-btn', function (event) {\n        if (ajaxCallIsRunning) {\n            return;\n        }\n        ajaxCallInProgress();\n        let expenseId = $(event.currentTarget).data('id');\n        renderData(expenseId);\n    });\n\n    window.renderData = function (id) {\n        $.ajax({\n            url: expenseUrl + '/' + id + '/edit',\n            type: 'GET',\n            success: function (result) {\n                if (result.success) {\n                    let ext = result.data.document_url.split('.').\n                        pop().\n                        toLowerCase();\n                    if (ext == 'pdf') {\n                        $('#editPreviewImage').attr('src', pdfDocumentImageUrl);\n                    } else if ((ext == 'docx') || (ext == 'doc')) {\n                        $('#editPreviewImage').\n                            attr('src', docxDocumentImageUrl);\n                    } else if (ext == '') {\n                        $('#editPreviewImage').\n                            attr('src', defaultDocumentImageUrl);\n                    } else {\n                        $('#editPreviewImage').\n                            attr('src', result.data.document_url);\n                    }\n\n                    $('#editExpenseId').val(result.data.id);\n                    $('#editExpenseHeadId').\n                        val(result.data.expense_head).\n                        trigger('change.select2');\n                    $('#editName').val(result.data.name);\n                    $('#editDate').val(format(result.data.date, 'YYYY-MM-DD'));\n                    $('#editInvoiceNumber').val(result.data.invoice_number);\n                    $('#editAmount').val(result.data.amount);\n                    $('.price-input').trigger('input');\n                    $('#editDescription').val(result.data.description);\n                    if (isEmpty(result.data.document_url)) {\n                        $('#documentUrl').text('');\n                    } else {\n                        $('#documentUrl').html('View');\n                        $('#documentUrl').\n                            attr('href', result.data.document_url);\n                    }\n                    $('#EditModal').modal('show');\n                    ajaxCallCompleted();\n                }\n            },\n            error: function (result) {\n                manageAjaxErrors(result);\n            },\n        });\n    };\n\n    $(document).on('submit', '#editForm', function (event) {\n        event.preventDefault();\n        $('#btnSave').attr('disabled', true);\n        let loadingButton = jQuery(this).find('#btnEditSave');\n        loadingButton.button('loading');\n        let id = $('#editExpenseId').val();\n        let url = expenseUrl + '/' + id + '/update';\n        let data = {\n            'formSelector': $(this),\n            'url': url,\n            'type': 'POST',\n        };\n        editExpenseRecord(data, loadingButton);\n    });\n\n    window.editExpenseRecord = function (\n        data, loadingButton, modalSelector = '#EditModal',\n        btnToDisabledSelector = '') {\n        let formData = (data.formSelector === '')\n            ? data.formData\n            : new FormData(\n                $(data.formSelector)[0]);\n        $.ajax({\n            url: data.url,\n            type: data.type,\n            data: formData,\n            processData: false,\n            contentType: false,\n            success: function (result) {\n                if (result.success) {\n                    displaySuccessMessage(result.message);\n                    $(modalSelector).modal('hide');\n                    setTimeout(function () {\n                        window.location.reload();\n                    }, 3000);\n                }\n            },\n            error: function (result) {\n                UnprocessableInputError(result);\n            },\n            complete: function () {\n                loadingButton.button('reset');\n                $(btnToDisabledSelector).attr('disabled', true);\n            },\n        });\n    };\n\n    $('#EditModal').on('hidden.bs.modal', function () {\n        resetModalForm('#editForm', '#editValidationErrorsBox');\n    });\n\n    $(document).on('change', '#editAttachment', function () {\n        let extension = isValidDocument($(this), '#editValidationErrorsBox');\n        if (!isEmpty(extension) && extension != false) {\n            $('#editValidationErrorsBox').html('').hide();\n            displayDocument(this, '#editPreviewImage', extension);\n        }\n    });\n\n    window.isValidDocument = function (\n        inputSelector, validationMessageSelector) {\n        let ext = $(inputSelector).val().split('.').pop().toLowerCase();\n        if ($.inArray(ext, ['png', 'jpg', 'jpeg', 'pdf', 'doc', 'docx']) ==\n            -1) {\n            $(inputSelector).val('');\n            $(validationMessageSelector).\n                html(documentError).show();\n            return false;\n        }\n        return ext;\n    };\n});\n"],"sourceRoot":""}