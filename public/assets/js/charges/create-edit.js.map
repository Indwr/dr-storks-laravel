{"version":3,"sources":["webpack:///./resources/assets/js/charges/create-edit.js"],"names":["$","document","ready","select2","width","on","focus","window","changeChargeCategory","selector","id","ajax","url","changeChargeTypeUrl","type","dataType","data","success","empty","each","i","v","append","attr","text","this","val","event","preventDefault","loadingButton","jQuery","find","button","chargeCreateUrl","serialize","result","displaySuccessMessage","message","modal","DataTable","reload","error","printErrorMessage","complete","ajaxCallIsRunning","ajaxCallInProgress","chargeId","currentTarget","renderData","chargeUrl","charge_type","trigger","code","description","addCommas","standard_charge","setTimeout","charge_category_id","ajaxCallCompleted","manageAjaxErrors","UnprocessableInputError","resetModalForm"],"mappings":"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","file":"/assets/js/charges/create-edit.js","sourcesContent":["$(document).ready(function () {\n    'use strict';\n\n    $('#chargeTypeId,#chargeCategoryId,#editChargeTypeId,#editChargeCategoryId,#chargeType').\n        select2({\n            width: '100%',\n        });\n\n    $('#addModal, #editModal').on('shown.bs.modal', function () {\n        $('#chargeTypeId, #editChargeTypeId:first').focus();\n    });\n\n    window.changeChargeCategory = function (selector, id) {\n        $.ajax({\n            url: changeChargeTypeUrl,\n            type: 'get',\n            dataType: 'json',\n            data: { id: id },\n            success: function (data) {\n                $(selector).empty();\n                $.each(data.data, function (i, v) {\n                    $(selector).\n                        append($('<option></option>').attr('value', i).text(v));\n                });\n            },\n        });\n    };\n    \n    $('#chargeTypeId').on('change', function () {\n       changeChargeCategory('#chargeCategoryId',$(this).val());\n    });\n    $('#editChargeTypeId').on('change', function () {\n       changeChargeCategory('#editChargeCategoryId',$(this).val());\n    });\n    \n    $(document).on('submit', '#addNewForm', function (event) {\n        event.preventDefault();\n        var loadingButton = jQuery(this).find('#btnSave');\n        loadingButton.button('loading');\n        $.ajax({\n            url: chargeCreateUrl,\n            type: 'POST',\n            data: $(this).serialize(),\n            success: function (result) {\n                if (result.success) {\n                    displaySuccessMessage(result.message);\n                    $('#addModal').modal('hide');\n                    $('#chargesTbl').DataTable().ajax.reload(null, false);\n                }\n            },\n            error: function (result) {\n                printErrorMessage('#validationErrorsBox', result);\n            },\n            complete: function () {\n                loadingButton.button('reset');\n            },\n        });\n    });\n\n    $(document).on('click', '.edit-btn', function (event) {\n        if (ajaxCallIsRunning) {\n            return;\n        }\n        ajaxCallInProgress();\n        let chargeId = $(event.currentTarget).data('id');\n        renderData(chargeId);\n    });\n\n    window.renderData = function (id) {\n        $.ajax({\n            url: chargeUrl + '/' + id + '/edit',\n            type: 'GET',\n            success: function (result) {\n                if (result.success) {\n                    $('#chargeId').val(result.data.id);\n                    $('#editChargeTypeId').val(result.data.charge_type).trigger('change.select2');\n                    changeChargeCategory('#editChargeCategoryId',result.data.charge_type);\n                    $('#editCode').val(result.data.code);\n                    $('#editDescription').val(result.data.description);\n                    $('#editStdCharge').val(addCommas(result.data.standard_charge));\n                    setTimeout(function(){\n                        $('#editChargeCategoryId').val(result.data.charge_category_id).trigger('change.select2');\n                    }, 2000);\n                    $('#editModal').modal('show');\n                    ajaxCallCompleted();\n                }\n            },\n            error: function (result) {\n                manageAjaxErrors(result);\n            },\n        });\n    };\n\n    $(document).on('submit', '#editForm', function (event) {\n        event.preventDefault();\n        var loadingButton = jQuery(this).find('#btnEditSave');\n        loadingButton.button('loading');\n        let id = $('#chargeId').val();\n        $.ajax({\n            url: chargeUrl + '/' + id,\n            type: 'patch',\n            data: $(this).serialize(),\n            success: function (result) {\n                if (result.success) {\n                    displaySuccessMessage(result.message);\n                    $('#editModal').modal('hide');\n                    $('#chargesTbl').DataTable().ajax.reload(null, false);\n                }\n            },\n            error: function (result) {\n                UnprocessableInputError(result);\n            },\n            complete: function () {\n                loadingButton.button('reset');\n            },\n        });\n    });\n\n    $('#addModal').on('hidden.bs.modal', function () {\n        resetModalForm('#addNewForm', '#validationErrorsBox');\n        $('#chargeTypeId,#chargeCategoryId').val('').trigger('change.select2');\n    });\n\n    $('#editModal').on('hidden.bs.modal', function () {\n        resetModalForm('#editForm', '#editValidationErrorsBox');\n        $('#editChargeTypeId,#editChargeCategoryId').val('').trigger('change.select2');\n    });\n});\n"],"sourceRoot":""}