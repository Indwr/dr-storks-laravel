{"version":3,"sources":["webpack:///./resources/assets/js/document/document-details-edit.js"],"names":["$","document","ready","select2","width","on","event","ajaxCallIsRunning","ajaxCallInProgress","documentId","currentTarget","data","renderData","window","id","ajax","url","documentsUrl","type","success","result","ext","document_url","split","pop","toLowerCase","attr","pdfDocumentImageUrl","docxDocumentImageUrl","val","document_type_id","trigger","patient_id","title","notes","modal","ajaxCallCompleted","error","manageAjaxErrors","preventDefault","loadingButton","jQuery","this","find","button","editDocumentRecord","modalSelector","btnToDisabledSelector","formData","formSelector","FormData","processData","contentType","displaySuccessMessage","message","setTimeout","location","reload","UnprocessableInputError","complete","resetModalForm","extension","isValidDocument","isEmpty","html","hide","displayDocument","inputSelector","validationMessageSelector","inArray","show"],"mappings":"AAAAA,EAAEC,UAAUC,OAAM,WACd,aAEAF,EAAE,uCACEG,QAAQ,CACJC,MAAO,SAGfJ,EAAEC,UAAUI,GAAG,QAAS,aAAa,SAAUC,GAC3C,IAAIC,kBAAJ,CAGAC,qBACA,IAAIC,EAAaT,EAAEM,EAAMI,eAAeC,KAAK,MAC7CC,WAAWH,OAGfI,OAAOD,WAAa,SAAUE,GAC1Bd,EAAEe,KAAK,CACHC,IAAKC,aAAe,IAAMH,EAAK,QAC/BI,KAAM,MACNC,QAAS,SAAUC,GACf,GAAIA,EAAOD,QAAS,CAChB,IAAIE,EAAMD,EAAOT,KAAKW,aAAaC,MAAM,KACrCC,MACAC,cACO,OAAPJ,EACArB,EAAE,qBAAqB0B,KAAK,MAAOC,qBACpB,QAAPN,GAA0B,OAAPA,EAC3BrB,EAAE,qBACE0B,KAAK,MAAOE,sBAEhB5B,EAAE,qBACE0B,KAAK,MAAON,EAAOT,KAAKW,cAGhCtB,EAAE,uBACE6B,IAAIT,EAAOT,KAAKmB,kBAChBC,QAAQ,kBACZ/B,EAAE,kBACE6B,IAAIT,EAAOT,KAAKqB,YAChBD,QAAQ,kBACZ/B,EAAE,cAAc6B,IAAIT,EAAOT,KAAKsB,OAChCjC,EAAE,gBAAgB0B,KAAK,OAAQN,EAAOT,KAAKW,cAC3CtB,EAAE,eAAe6B,IAAIT,EAAOT,KAAKG,IACjCd,EAAE,cAAc6B,IAAIT,EAAOT,KAAKuB,OAChClC,EAAE,cAAcmC,MAAM,QACtBC,sBAGRC,MAAO,SAAUjB,GACbkB,iBAAiBlB,OAK7BpB,EAAEC,UAAUI,GAAG,SAAU,aAAa,SAAUC,GAC5CA,EAAMiC,iBACN,IAAIC,EAAgBC,OAAOC,MAAMC,KAAK,gBACtCH,EAAcI,OAAO,WACrB,IAAI9B,EAAKd,EAAE,eAAe6B,MACtBb,EAAMC,aAAe,IAAMH,EAAK,UAChCH,EAAO,CACP,aAAgBX,EAAE0C,MAClB,IAAO1B,EACP,KAAQ,QAEZ6B,mBAAmBlC,EAAM6B,MAG7B3B,OAAOgC,mBAAqB,SACxBlC,EAAM6B,GACsB,IADPM,EACO,uDADS,aACrCC,EAA4B,uDAAJ,GACpBC,EAAkC,KAAtBrC,EAAKsC,aACftC,EAAKqC,SACL,IAAIE,SACFlD,EAAEW,EAAKsC,cAAc,IAC7BjD,EAAEe,KAAK,CACHC,IAAKL,EAAKK,IACVE,KAAMP,EAAKO,KACXP,KAAMqC,EACNG,aAAa,EACbC,aAAa,EACbjC,QAAS,SAAUC,GACXA,EAAOD,UACPkC,sBAAsBjC,EAAOkC,SAC7BtD,EAAE8C,GAAeX,MAAM,QACvBoB,YAAW,WACP1C,OAAO2C,SAASC,WACjB,OAGXpB,MAAO,SAAUjB,GACbsC,wBAAwBtC,IAE5BuC,SAAU,WACNnB,EAAcI,OAAO,SACrB5C,EAAE+C,GAAuBrB,KAAK,YAAY,OAKtD1B,EAAE,cAAcK,GAAG,mBAAmB,WAClCuD,eAAe,YAAa,0CAIpC5D,EAAEC,UAAUI,GAAG,SAAU,sBAAsB,WAC3C,IAAIwD,EAAYC,gBAAgB9D,EAAE0C,MAC9B,oCACCqB,QAAQF,IAA2B,GAAbA,IACvB7D,EAAE,oCAAoCgE,KAAK,IAAIC,OAC/CC,gBAAgBxB,KAAM,oBAAqBmB,OAInDhD,OAAOiD,gBAAkB,SAAUK,EAAeC,GAC9C,IAAI/C,EAAMrB,EAAEmE,GAAetC,MAAMN,MAAM,KAAKC,MAAMC,cAClD,OAAqE,GAAjEzB,EAAEqE,QAAQhD,EAAK,CAAC,MAAO,MAAO,OAAQ,MAAO,MAAO,UACpDrB,EAAEmE,GAAetC,IAAI,IACrB7B,EAAEoE,GACEJ,KACI,wEACJM,QACG,GAEJjD","file":"/assets/js/document/document-details-edit.js","sourcesContent":["$(document).ready(function () {\n    'use strict';\n\n    $('#editPatientId, #editDocumentTypeId').\n        select2({\n            width: '100%',\n        });\n\n    $(document).on('click', '.edit-btn', function (event) {\n        if (ajaxCallIsRunning) {\n            return;\n        }\n        ajaxCallInProgress();\n        let documentId = $(event.currentTarget).data('id');\n        renderData(documentId);\n    });\n\n    window.renderData = function (id) {\n        $.ajax({\n            url: documentsUrl + '/' + id + '/edit',\n            type: 'GET',\n            success: function (result) {\n                if (result.success) {\n                    let ext = result.data.document_url.split('.').\n                        pop().\n                        toLowerCase();\n                    if (ext == 'pdf') {\n                        $('#editPreviewImage').attr('src', pdfDocumentImageUrl);\n                    } else if ((ext == 'docx') || (ext == 'doc')) {\n                        $('#editPreviewImage').\n                            attr('src', docxDocumentImageUrl);\n                    } else {\n                        $('#editPreviewImage').\n                            attr('src', result.data.document_url);\n                    }\n\n                    $('#editDocumentTypeId').\n                        val(result.data.document_type_id).\n                        trigger('change.select2');\n                    $('#editPatientId').\n                        val(result.data.patient_id).\n                        trigger('change.select2');\n                    $('#editTitle').val(result.data.title);\n                    $('#documentUrl').attr('href', result.data.document_url);\n                    $('#documentId').val(result.data.id);\n                    $('#editNotes').val(result.data.notes);\n                    $('#EditModal').modal('show');\n                    ajaxCallCompleted();\n                }\n            },\n            error: function (result) {\n                manageAjaxErrors(result);\n            },\n        });\n    };\n\n    $(document).on('submit', '#editForm', function (event) {\n        event.preventDefault();\n        let loadingButton = jQuery(this).find('#btnEditSave');\n        loadingButton.button('loading');\n        let id = $('#documentId').val();\n        let url = documentsUrl + '/' + id + '/update';\n        let data = {\n            'formSelector': $(this),\n            'url': url,\n            'type': 'POST',\n        };\n        editDocumentRecord(data, loadingButton);\n    });\n\n    window.editDocumentRecord = function (\n        data, loadingButton, modalSelector = '#EditModal',\n        btnToDisabledSelector = '') {\n        let formData = (data.formSelector === '')\n            ? data.formData\n            : new FormData(\n                $(data.formSelector)[0]);\n        $.ajax({\n            url: data.url,\n            type: data.type,\n            data: formData,\n            processData: false,\n            contentType: false,\n            success: function (result) {\n                if (result.success) {\n                    displaySuccessMessage(result.message);\n                    $(modalSelector).modal('hide');\n                    setTimeout(function () {\n                        window.location.reload();\n                    }, 3000);\n                }\n            },\n            error: function (result) {\n                UnprocessableInputError(result);\n            },\n            complete: function () {\n                loadingButton.button('reset');\n                $(btnToDisabledSelector).attr('disabled', true);\n            },\n        });\n    };\n\n    $('#editModal').on('hidden.bs.modal', function () {\n        resetModalForm('#editForm', '#editDocumentValidationErrorsBox');\n    });\n});\n\n$(document).on('change', '#editDocumentImage', function () {\n    let extension = isValidDocument($(this),\n        '#editDocumentValidationErrorsBox');\n    if (!isEmpty(extension) && extension != false) {\n        $('#editDocumentValidationErrorsBox').html('').hide();\n        displayDocument(this, '#editPreviewImage', extension);\n    }\n});\n\nwindow.isValidDocument = function (inputSelector, validationMessageSelector) {\n    let ext = $(inputSelector).val().split('.').pop().toLowerCase();\n    if ($.inArray(ext, ['png', 'jpg', 'jpeg', 'pdf', 'doc', 'docx']) == -1) {\n        $(inputSelector).val('');\n        $(validationMessageSelector).\n            html(\n                'The document must be a file of type: jpeg, jpg, png, pdf, doc, docx.').\n            show();\n        return false;\n    }\n    return ext;\n};\n"],"sourceRoot":""}