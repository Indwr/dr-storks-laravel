{"version":3,"sources":["webpack:///./resources/assets/js/packages/create-edit.js"],"names":["$","document","ready","dropdownToSelecte2","selector","select2","placeholder","width","find","focus","on","data","associateServices","packageServiceItemHtml","prepareTemplateRender","append","uniqueId","resetServicePackageItemIndex","index","each","this","text","parents","remove","calculateAndSetTotalAmount","removeCommas","str","replace","window","isNumberKey","evt","element","charCode","which","event","keyCode","val","indexOf","qty","parseInt","rate","parent","siblings","amount","calculateAmount","addCommas","toString","totalAmount","discount","parseFloat","itemTotal","isEmpty","trim","toFixed","preventDefault","screenLock","attr","loadingButton","jQuery","button","formData","FormData","ajax","url","packageSaveUrl","type","dataType","processData","contentType","success","result","displaySuccessMessage","message","location","href","packageUrl","error","printErrorMessage","complete","screenUnLock"],"mappings":"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","file":"/assets/js/packages/create-edit.js","sourcesContent":["$(document).ready(function () {\n    'use strict';\n\n    const dropdownToSelecte2 = (selector) => {\n        $(selector).select2({\n            placeholder: 'Select Service',\n            width: '100%',\n        });\n    };\n\n    $('#packageForm').find('input:text:visible:first').focus();\n\n    dropdownToSelecte2('.serviceId');\n\n    $(document).on('click', '#addItem', function () {\n        let data = {\n            'services': associateServices,\n            'uniqueId': uniqueId,\n        };\n        let packageServiceItemHtml = prepareTemplateRender(\n            '#packageServiceTemplate', data);\n        $('.package-service-item-container').append(packageServiceItemHtml);\n        dropdownToSelecte2('.serviceId');\n        uniqueId++;\n\n        resetServicePackageItemIndex();\n    });\n\n    const resetServicePackageItemIndex = () => {\n        let index = 1;\n        $('.package-service-item-container>tr').each(function () {\n            $(this).find('.item-number').text(index);\n            index++;\n        });\n        if (index - 1 == 0) {\n            let data = {\n                'services': associateServices,\n                'uniqueId': uniqueId,\n            };\n            let packageServiceItemHtml = prepareTemplateRender(\n                '#packageServiceTemplate', data);\n            $('.package-service-item-container').append(packageServiceItemHtml);\n            dropdownToSelecte2('.serviceId');\n            uniqueId++;\n        }\n    };\n\n    $(document).on('click', '.delete-service-package-item', function () {\n        $(this).parents('tr').remove();\n        resetServicePackageItemIndex();\n        calculateAndSetTotalAmount();\n    });\n\n    const removeCommas = (str) => {\n        return str.replace(/,/g, '');\n    };\n\n    window.isNumberKey = (evt, element) => {\n        let charCode = (evt.which) ? evt.which : event.keyCode;\n\n        return !((charCode !== 46 || $(element).val().indexOf('.') !== -1) &&\n            (charCode < 48 || charCode > 57));\n    };\n\n    $(document).on('keyup', '.qty', function () {\n        let qty = parseInt($(this).val());\n        let rate = $(this).parent().siblings().find('.price').val();\n        rate = parseInt(removeCommas(rate));\n        let amount = calculateAmount(qty, rate);\n        $(this).parent().siblings('.amount').text(addCommas(amount.toString()));\n        calculateAndSetTotalAmount();\n    });\n\n    $(document).on('keyup', '.price', function () {\n        let rate = $(this).val();\n        rate = parseInt(removeCommas(rate));\n        let qty = parseInt($(this).parent().siblings().find('.qty').val());\n        let amount = calculateAmount(qty, rate);\n        $(this).parent().siblings('.amount').text(addCommas(amount.toString()));\n        calculateAndSetTotalAmount();\n    });\n\n    $(document).on('keyup', '.discount', function () {\n        calculateAndSetTotalAmount();\n    });\n\n    const calculateAmount = (qty, rate) => {\n        if (qty > 0 && rate > 0) {\n            return qty * rate;\n        } else {\n            return 0;\n        }\n    };\n\n    const calculateAndSetTotalAmount = () => {\n        let totalAmount = 0;\n        let discount = parseFloat(\n            $('.discount').val() !== '' ? $('.discount').val() : 0);\n        $('.package-service-item-container>tr').each(function () {\n            let itemTotal = $(this).find('.item-total').text();\n            itemTotal = removeCommas(itemTotal);\n            itemTotal = isEmpty($.trim(itemTotal)) ? 0 : parseInt(itemTotal);\n            totalAmount += itemTotal;\n        });\n        totalAmount = parseFloat(totalAmount);\n        totalAmount -= (totalAmount * discount / 100);\n        $('#total').text(addCommas(totalAmount.toFixed(2)));\n\n        //set hidden input value\n        $('#total_amount').val(totalAmount);\n    };\n\n    $(document).on('submit', '#packageForm', function (event) {\n        event.preventDefault();\n        screenLock();\n        $('#saveBtn').attr('disabled', true);\n        let loadingButton = jQuery(this).find('#saveBtn');\n        loadingButton.button('loading');\n        let formData = new FormData($(this)[0]);\n        $.ajax({\n            url: packageSaveUrl,\n            type: 'POST',\n            dataType: 'json',\n            data: formData,\n            processData: false,\n            contentType: false,\n            success: function (result) {\n                displaySuccessMessage(result.message);\n                window.location.href = packageUrl;\n            },\n            error: function (result) {\n                printErrorMessage('#validationErrorsBox', result);\n                $('#saveBtn').attr('disabled', false);\n            },\n            complete: function () {\n                screenUnLock();\n                loadingButton.button('reset');\n            },\n        });\n    });\n});\n"],"sourceRoot":""}