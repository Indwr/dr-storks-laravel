{"version":3,"sources":["webpack:///./resources/assets/js/incomes/incomes-details-edit.js"],"names":["$","document","ready","on","focus","select2","width","datetimepicker","DatetimepickerDefaults","format","useCurrent","sideBySide","event","id","currentTarget","data","renderData","window","ajax","url","incomeUrl","type","success","result","ext","document_url","split","pop","toLowerCase","attr","pdfDocumentImageUrl","docxDocumentImageUrl","defaultDocumentImageUrl","val","income_head","trigger","name","date","invoice_number","amount","description","isEmpty","text","html","modal","error","manageAjaxErrors","preventDefault","loadingButton","jQuery","this","find","button","editIncomeRecord","modalSelector","btnToDisabledSelector","formData","formSelector","FormData","processData","contentType","displaySuccessMessage","message","setTimeout","location","reload","UnprocessableInputError","complete","resetModalForm","extension","isValidDocument","hide","displayDocument","inputSelector","validationMessageSelector","inArray","documentError","show"],"mappings":"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","file":"/assets/js/incomes/incomes-details-edit.js","sourcesContent":["$(document).ready(function () {\n    'use strict';\n\n    $('#addModal, #EditModal').on('shown.bs.modal', function () {\n        $('#incomeId, #editIncomeHeadId:first').focus();\n    });\n\n    $('#incomeId,#editIncomeHeadId,#incomeHead').select2({\n        width: '100%',\n    });\n\n    $('#date, #editDate').datetimepicker(DatetimepickerDefaults({\n        format: 'YYYY-MM-DD',\n        useCurrent: true,\n        sideBySide: true,\n    }));\n\n    $(document).on('click', '.edit-btn', function (event) {\n        let id = $(event.currentTarget).data('id');\n        renderData(id);\n    });\n\n    window.renderData = function (id) {\n        $.ajax({\n            url: incomeUrl + '/' + id + '/edit',\n            type: 'GET',\n            success: function (result) {\n                if (result.success) {\n                    let ext = result.data.document_url.split('.').\n                        pop().\n                        toLowerCase();\n                    if (ext == 'pdf') {\n                        $('#editPreviewImage').attr('src', pdfDocumentImageUrl);\n                    } else if ((ext == 'docx') || (ext == 'doc')) {\n                        $('#editPreviewImage').\n                            attr('src', docxDocumentImageUrl);\n                    } else if (ext == '') {\n                        $('#editPreviewImage').\n                            attr('src', defaultDocumentImageUrl);\n                    } else {\n                        $('#editPreviewImage').\n                            attr('src', result.data.document_url);\n                    }\n\n                    $('#editIncomeId').val(result.data.id);\n                    $('#editIncomeHeadId').\n                        val(result.data.income_head).\n                        trigger('change.select2');\n                    $('#editName').val(result.data.name);\n                    $('#editDate').val(format(result.data.date, 'YYYY-MM-DD'));\n                    $('#editInvoiceNumber').val(result.data.invoice_number);\n                    $('#editAmount').val(result.data.amount);\n                    $('.price-input').trigger('input');\n                    $('#editDescription').val(result.data.description);\n                    if (isEmpty(result.data.document_url)) {\n                        $('#documentUrl').text('');\n                    } else {\n                        $('#documentUrl').html('View');\n                        $('#documentUrl').\n                            attr('href', result.data.document_url);\n                    }\n                    $('#EditModal').modal('show');\n                }\n            },\n            error: function (result) {\n                manageAjaxErrors(result);\n            },\n        });\n    };\n\n    $(document).on('submit', '#editForm', function (event) {\n        event.preventDefault();\n        $('#btnSave').attr('disabled', true);\n        let loadingButton = jQuery(this).find('#btnEditSave');\n        loadingButton.button('loading');\n        let id = $('#editIncomeId').val();\n        let url = incomeUrl + '/' + id + '/update';\n        let data = {\n            'formSelector': $(this),\n            'url': url,\n            'type': 'POST',\n        };\n        editIncomeRecord(data, loadingButton);\n    });\n\n    window.editIncomeRecord = function (\n        data, loadingButton, modalSelector = '#EditModal',\n        btnToDisabledSelector = '') {\n        let formData = (data.formSelector === '')\n            ? data.formData\n            : new FormData(\n                $(data.formSelector)[0]);\n        $.ajax({\n            url: data.url,\n            type: data.type,\n            data: formData,\n            processData: false,\n            contentType: false,\n            success: function (result) {\n                if (result.success) {\n                    displaySuccessMessage(result.message);\n                    $(modalSelector).modal('hide');\n                    setTimeout(function () {\n                        window.location.reload();\n                    }, 3000);\n                }\n            },\n            error: function (result) {\n                UnprocessableInputError(result);\n            },\n            complete: function () {\n                loadingButton.button('reset');\n                $(btnToDisabledSelector).attr('disabled', true);\n            },\n        });\n    };\n\n    $('#EditModal').on('hidden.bs.modal', function () {\n        resetModalForm('#editForm', '#editValidationErrorsBox');\n    });\n\n    $(document).on('change', '#editAttachment', function () {\n        let extension = isValidDocument($(this), '#editValidationErrorsBox');\n        if (!isEmpty(extension) && extension != false) {\n            $('#editValidationErrorsBox').html('').hide();\n            displayDocument(this, '#editPreviewImage', extension);\n        }\n    });\n\n    window.isValidDocument = function (\n        inputSelector, validationMessageSelector) {\n        let ext = $(inputSelector).val().split('.').pop().toLowerCase();\n        if ($.inArray(ext, ['png', 'jpg', 'jpeg', 'pdf', 'doc', 'docx']) ==\n            -1) {\n            $(inputSelector).val('');\n            $(validationMessageSelector).\n                html(documentError).show();\n            return false;\n        }\n        return ext;\n    };\n});\n\n\n\n"],"sourceRoot":""}